

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sympy.polys.polytools &mdash; SymPy 0.7.3 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-autocomplete.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.7.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/SymPy-Favicon.ico"/>
    <link rel="top" title="SymPy 0.7.3 documentation" href="../../../index.html" />
    <link rel="up" title="sympy" href="../../sympy.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">SymPy 0.7.3 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../sympy.html" accesskey="U">sympy</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for sympy.polys.polytools</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;User-friendly public interface to polynomial functions. &quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">sympy.core</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">Basic</span><span class="p">,</span> <span class="n">Expr</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Mul</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Rational</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">sympy.core.mul</span> <span class="kn">import</span> <span class="n">_keep_coeff</span>

<span class="kn">from</span> <span class="nn">sympy.core.basic</span> <span class="kn">import</span> <span class="n">preorder_traversal</span>

<span class="kn">from</span> <span class="nn">sympy.core.relational</span> <span class="kn">import</span> <span class="n">Relational</span>

<span class="kn">from</span> <span class="nn">sympy.core.sympify</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">sympify</span><span class="p">,</span> <span class="n">SympifyError</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">sympy.core.decorators</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_sympifyit</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">sympy.polys.polyclasses</span> <span class="kn">import</span> <span class="n">DMP</span>

<span class="kn">from</span> <span class="nn">sympy.polys.polyutils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">basic_from_dict</span><span class="p">,</span>
    <span class="n">_sort_gens</span><span class="p">,</span>
    <span class="n">_unify_gens</span><span class="p">,</span>
    <span class="n">_dict_reorder</span><span class="p">,</span>
    <span class="n">_dict_from_expr</span><span class="p">,</span>
    <span class="n">_parallel_dict_from_expr</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">sympy.polys.rationaltools</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">together</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">sympy.polys.rootisolation</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">dup_isolate_real_roots_list</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">sympy.polys.groebnertools</span> <span class="kn">import</span> <span class="n">groebner</span> <span class="k">as</span> <span class="n">_groebner</span>
<span class="kn">from</span> <span class="nn">sympy.polys.fglmtools</span> <span class="kn">import</span> <span class="n">matrix_fglm</span>

<span class="kn">from</span> <span class="nn">sympy.polys.monomials</span> <span class="kn">import</span> <span class="n">Monomial</span>
<span class="kn">from</span> <span class="nn">sympy.polys.orderings</span> <span class="kn">import</span> <span class="n">monomial_key</span>

<span class="kn">from</span> <span class="nn">sympy.polys.polyerrors</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OperationNotSupported</span><span class="p">,</span> <span class="n">DomainError</span><span class="p">,</span>
    <span class="n">CoercionFailed</span><span class="p">,</span> <span class="n">UnificationFailed</span><span class="p">,</span>
    <span class="n">GeneratorsNeeded</span><span class="p">,</span> <span class="n">PolynomialError</span><span class="p">,</span>
    <span class="n">MultivariatePolynomialError</span><span class="p">,</span>
    <span class="n">ExactQuotientFailed</span><span class="p">,</span>
    <span class="n">PolificationFailed</span><span class="p">,</span>
    <span class="n">ComputationFailed</span><span class="p">,</span>
    <span class="n">GeneratorsError</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">sympy.utilities</span> <span class="kn">import</span> <span class="n">group</span><span class="p">,</span> <span class="n">sift</span><span class="p">,</span> <span class="n">public</span>

<span class="kn">import</span> <span class="nn">sympy.polys</span>
<span class="kn">import</span> <span class="nn">sympy.mpmath</span>

<span class="kn">from</span> <span class="nn">sympy.polys.domains</span> <span class="kn">import</span> <span class="n">FF</span><span class="p">,</span> <span class="n">QQ</span>
<span class="kn">from</span> <span class="nn">sympy.polys.constructor</span> <span class="kn">import</span> <span class="n">construct_domain</span>

<span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">polyoptions</span> <span class="k">as</span> <span class="n">options</span>

<span class="kn">from</span> <span class="nn">sympy.core.compatibility</span> <span class="kn">import</span> <span class="n">iterable</span>

<span class="nd">@public</span>
<div class="viewcode-block" id="Poly"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly">[docs]</a><span class="k">class</span> <span class="nc">Poly</span><span class="p">(</span><span class="n">Expr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generic class for representing polynomial expressions. &quot;&quot;&quot;</span>

    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;rep&#39;</span><span class="p">,</span> <span class="s">&#39;gens&#39;</span><span class="p">]</span>

    <span class="n">is_commutative</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">is_Poly</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new polynomial instance out of something useful. &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="s">&#39;order&#39;</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;&#39;order&#39; keyword is not implemented yet&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">iterable</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rep</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">rep</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_poly</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_expr</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Poly.new"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.new">[docs]</a>    <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct :class:`Poly` instance from raw representation. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">DMP</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span>
                <span class="s">&quot;invalid polynomial representation: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">rep</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rep</span><span class="o">.</span><span class="n">lev</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;invalid arguments: </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">gens</span><span class="p">))</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">Basic</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">rep</span> <span class="o">=</span> <span class="n">rep</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">gens</span> <span class="o">=</span> <span class="n">gens</span>

        <span class="k">return</span> <span class="n">obj</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Poly.from_dict"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.from_dict">[docs]</a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a polynomial from a ``dict``. &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Poly.from_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.from_list">[docs]</a>    <span class="k">def</span> <span class="nf">from_list</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a polynomial from a ``list``. &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_list</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Poly.from_poly"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.from_poly">[docs]</a>    <span class="k">def</span> <span class="nf">from_poly</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a polynomial from a polynomial. &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_poly</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Poly.from_expr"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.from_expr">[docs]</a>    <span class="k">def</span> <span class="nf">from_expr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a polynomial from an expression. &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_expr</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_dict</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a polynomial from a ``dict``. &quot;&quot;&quot;</span>
        <span class="n">gens</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">gens</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GeneratorsNeeded</span><span class="p">(</span>
                <span class="s">&quot;can&#39;t initialize from &#39;dict&#39; without generators&quot;</span><span class="p">)</span>

        <span class="n">level</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span>

        <span class="k">if</span> <span class="n">domain</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">domain</span><span class="p">,</span> <span class="n">rep</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">monom</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">rep</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">rep</span><span class="p">[</span><span class="n">monom</span><span class="p">]</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">DMP</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">domain</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_list</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a polynomial from a ``list``. &quot;&quot;&quot;</span>
        <span class="n">gens</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">gens</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GeneratorsNeeded</span><span class="p">(</span>
                <span class="s">&quot;can&#39;t initialize from &#39;list&#39; without generators&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultivariatePolynomialError</span><span class="p">(</span>
                <span class="s">&quot;&#39;list&#39; representation not supported&quot;</span><span class="p">)</span>

        <span class="n">level</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span>

        <span class="k">if</span> <span class="n">domain</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">domain</span><span class="p">,</span> <span class="n">rep</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">convert</span><span class="p">,</span> <span class="n">rep</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">DMP</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">domain</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_poly</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a polynomial from a polynomial. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cls</span> <span class="o">!=</span> <span class="n">rep</span><span class="o">.</span><span class="n">__class__</span><span class="p">:</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rep</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">rep</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

        <span class="n">gens</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">gens</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">field</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span>

        <span class="k">if</span> <span class="n">gens</span> <span class="ow">and</span> <span class="n">rep</span><span class="o">.</span><span class="n">gens</span> <span class="o">!=</span> <span class="n">gens</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">rep</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">gens</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_expr</span><span class="p">(</span><span class="n">rep</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">opt</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rep</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="o">*</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">if</span> <span class="s">&#39;domain&#39;</span> <span class="ow">in</span> <span class="n">opt</span> <span class="ow">and</span> <span class="n">domain</span><span class="p">:</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">rep</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_expr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a polynomial from an expression. &quot;&quot;&quot;</span>
        <span class="n">rep</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">_dict_from_expr</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_hashable_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow SymPy to hash Poly instances. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Poly</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__hash__</span><span class="p">()</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.free_symbols"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.free_symbols">[docs]</a>    <span class="k">def</span> <span class="nf">free_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Free symbols of a polynomial expression.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1).free_symbols</span>
<span class="sd">        set([x])</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + y).free_symbols</span>
<span class="sd">        set([x, y])</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + y, x).free_symbols</span>
<span class="sd">        set([x, y])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gens</span><span class="p">:</span>
            <span class="n">symbols</span> <span class="o">|=</span> <span class="n">gen</span><span class="o">.</span><span class="n">free_symbols</span>

        <span class="k">return</span> <span class="n">symbols</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols_in_domain</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.free_symbols_in_domain"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.free_symbols_in_domain">[docs]</a>    <span class="k">def</span> <span class="nf">free_symbols_in_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Free symbols of the domain of ``self``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1).free_symbols_in_domain</span>
<span class="sd">        set()</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + y).free_symbols_in_domain</span>
<span class="sd">        set()</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + y, x).free_symbols_in_domain</span>
<span class="sd">        set([y])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">domain</span><span class="p">,</span> <span class="n">symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">domain</span><span class="o">.</span><span class="n">is_Composite</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="n">domain</span><span class="o">.</span><span class="n">symbols</span><span class="p">:</span>
                <span class="n">symbols</span> <span class="o">|=</span> <span class="n">gen</span><span class="o">.</span><span class="n">free_symbols</span>
        <span class="k">elif</span> <span class="n">domain</span><span class="o">.</span><span class="n">is_EX</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">():</span>
                <span class="n">symbols</span> <span class="o">|=</span> <span class="n">coeff</span><span class="o">.</span><span class="n">free_symbols</span>

        <span class="k">return</span> <span class="n">symbols</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.args"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.args">[docs]</a>    <span class="k">def</span> <span class="nf">args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Don&#39;t mess up with the core.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).args</span>
<span class="sd">        (x**2 + 1,)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),)</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.gen"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.gen">[docs]</a>    <span class="k">def</span> <span class="nf">gen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the principal generator.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).gen</span>
<span class="sd">        x</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.domain"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.domain">[docs]</a>    <span class="k">def</span> <span class="nf">domain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the ground domain of ``self``. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.zero"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.zero">[docs]</a>    <span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return zero polynomial with ``self``&#39;s properties. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">zero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">),</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.one"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.one">[docs]</a>    <span class="k">def</span> <span class="nf">one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return one polynomial with ``self``&#39;s properties. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">one</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">),</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.unit"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.unit">[docs]</a>    <span class="k">def</span> <span class="nf">unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return unit polynomial with ``self``&#39;s properties. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">),</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.unify"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.unify">[docs]</a>    <span class="k">def</span> <span class="nf">unify</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make ``f`` and ``g`` belong to the same domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f, g = Poly(x/2 + 1), Poly(2*x + 1)</span>

<span class="sd">        &gt;&gt;&gt; f</span>
<span class="sd">        Poly(1/2*x + 1, x, domain=&#39;QQ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; g</span>
<span class="sd">        Poly(2*x + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; F, G = f.unify(g)</span>

<span class="sd">        &gt;&gt;&gt; F</span>
<span class="sd">        Poly(1/2*x + 1, x, domain=&#39;QQ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; G</span>
<span class="sd">        Poly(2*x + 1, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">F</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_unify</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">from_sympy</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
            <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">UnificationFailed</span><span class="p">(</span><span class="s">&quot;can&#39;t unify </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">DMP</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">DMP</span><span class="p">):</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="n">_unify_gens</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

            <span class="n">dom</span><span class="p">,</span> <span class="n">lev</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">unify</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="n">gens</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span> <span class="o">!=</span> <span class="n">gens</span><span class="p">:</span>
                <span class="n">f_monoms</span><span class="p">,</span> <span class="n">f_coeffs</span> <span class="o">=</span> <span class="n">_dict_reorder</span><span class="p">(</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">gens</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">dom</span><span class="p">:</span>
                    <span class="n">f_coeffs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">dom</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">f_coeffs</span> <span class="p">]</span>

                <span class="n">F</span> <span class="o">=</span> <span class="n">DMP</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">f_monoms</span><span class="p">,</span> <span class="n">f_coeffs</span><span class="p">))),</span> <span class="n">dom</span><span class="p">,</span> <span class="n">lev</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">gens</span> <span class="o">!=</span> <span class="n">gens</span><span class="p">:</span>
                <span class="n">g_monoms</span><span class="p">,</span> <span class="n">g_coeffs</span> <span class="o">=</span> <span class="n">_dict_reorder</span><span class="p">(</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">gens</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">dom</span><span class="p">:</span>
                    <span class="n">g_coeffs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">dom</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">g_coeffs</span> <span class="p">]</span>

                <span class="n">G</span> <span class="o">=</span> <span class="n">DMP</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">g_monoms</span><span class="p">,</span> <span class="n">g_coeffs</span><span class="p">))),</span> <span class="n">dom</span><span class="p">,</span> <span class="n">lev</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">G</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">UnificationFailed</span><span class="p">(</span><span class="s">&quot;can&#39;t unify </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>

        <span class="n">cls</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span>

        <span class="k">def</span> <span class="nf">per</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span> <span class="n">gens</span><span class="o">=</span><span class="n">gens</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">remove</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">gens</span> <span class="o">=</span> <span class="n">gens</span><span class="p">[:</span><span class="n">remove</span><span class="p">]</span> <span class="o">+</span> <span class="n">gens</span><span class="p">[</span><span class="n">remove</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span>

<div class="viewcode-block" id="Poly.per"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.per">[docs]</a>    <span class="k">def</span> <span class="nf">per</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">gens</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a Poly out of the given representation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, ZZ</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; from sympy.polys.polyclasses import DMP</span>

<span class="sd">        &gt;&gt;&gt; a = Poly(x**2 + 1)</span>

<span class="sd">        &gt;&gt;&gt; a.per(DMP([ZZ(1), ZZ(1)], ZZ), gens=[y])</span>
<span class="sd">        Poly(y + 1, y, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gens</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span>

        <span class="k">if</span> <span class="n">remove</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="n">gens</span><span class="p">[:</span><span class="n">remove</span><span class="p">]</span> <span class="o">+</span> <span class="n">gens</span><span class="p">[</span><span class="n">remove</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.set_domain"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.set_domain">[docs]</a>    <span class="k">def</span> <span class="nf">set_domain</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the ground domain of ``f``. &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;domain&#39;</span><span class="p">:</span> <span class="n">domain</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Poly.get_domain"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.get_domain">[docs]</a>    <span class="k">def</span> <span class="nf">get_domain</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the ground domain of ``f``. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span>
</div>
<div class="viewcode-block" id="Poly.set_modulus"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.set_modulus">[docs]</a>    <span class="k">def</span> <span class="nf">set_modulus</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">modulus</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the modulus of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(5*x**2 + 2*x - 1, x).set_modulus(2)</span>
<span class="sd">        Poly(x**2 + 1, x, modulus=2)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">modulus</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">Modulus</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">modulus</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">FF</span><span class="p">(</span><span class="n">modulus</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Poly.get_modulus"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.get_modulus">[docs]</a>    <span class="k">def</span> <span class="nf">get_modulus</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the modulus of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, modulus=2).get_modulus()</span>
<span class="sd">        2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">domain</span><span class="o">.</span><span class="n">is_FiniteField</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">characteristic</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;not a polynomial over a Galois field&quot;</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_eval_subs</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Internal implementation of :func:`subs`. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">old</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">new</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">PolynomialError</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>

<div class="viewcode-block" id="Poly.exclude"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.exclude">[docs]</a>    <span class="k">def</span> <span class="nf">exclude</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove unnecessary generators from ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import a, b, c, d, x</span>

<span class="sd">        &gt;&gt;&gt; Poly(a + x, a, b, c, d, x).exclude()</span>
<span class="sd">        Poly(a + x, a, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">J</span><span class="p">,</span> <span class="n">new</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">exclude</span><span class="p">()</span>
        <span class="n">gens</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">J</span><span class="p">:</span>
                <span class="n">gens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">gens</span><span class="o">=</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.replace"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.replace">[docs]</a>    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace ``x`` with ``y`` in generators list.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).replace(x, y)</span>
<span class="sd">        Poly(y**2 + 1, y, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_univariate</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gen</span><span class="p">,</span> <span class="n">x</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span>
                    <span class="s">&quot;syntax supported only in univariate case&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">:</span>
            <span class="n">dom</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">dom</span><span class="o">.</span><span class="n">is_Composite</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dom</span><span class="o">.</span><span class="n">symbols</span><span class="p">:</span>
                <span class="n">gens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
                <span class="n">gens</span><span class="p">[</span><span class="n">gens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">y</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">gens</span><span class="o">=</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;can&#39;t replace </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Poly.reorder"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.reorder">[docs]</a>    <span class="k">def</span> <span class="nf">reorder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Efficiently apply new order of generators.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + x*y**2, x, y).reorder(y, x)</span>
<span class="sd">        Poly(y**2*x + x**2, y, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">Options</span><span class="p">((),</span> <span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span><span class="p">:</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="n">_sort_gens</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">set</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">gens</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span>
                <span class="s">&quot;generators list can differ only up to order of elements&quot;</span><span class="p">)</span>

        <span class="n">rep</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">_dict_reorder</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">gens</span><span class="p">))))</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">DMP</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gens</span><span class="o">=</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.ltrim"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.ltrim">[docs]</a>    <span class="k">def</span> <span class="nf">ltrim</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gen</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove dummy generators from the &quot;left&quot; of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>

<span class="sd">        &gt;&gt;&gt; Poly(y**2 + y*z**2, x, y, z).ltrim(y)</span>
<span class="sd">        Poly(y**2 + y*z**2, y, z, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(</span><span class="n">native</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_gen_to_level</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">monom</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">rep</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">monom</span> <span class="o">=</span> <span class="n">monom</span><span class="p">[</span><span class="n">j</span><span class="p">:]</span>

            <span class="k">if</span> <span class="n">monom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
                <span class="n">terms</span><span class="p">[</span><span class="n">monom</span><span class="p">]</span> <span class="o">=</span> <span class="n">coeff</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;can&#39;t left trim </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

        <span class="n">gens</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="n">j</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">DMP</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.has_only_gens"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.has_only_gens">[docs]</a>    <span class="k">def</span> <span class="nf">has_only_gens</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return ``True`` if ``Poly(f, *gens)`` retains ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>

<span class="sd">        &gt;&gt;&gt; Poly(x*y + 1, x, y, z).has_only_gens(x, y)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(x*y + z, x, y, z).has_only_gens(x, y)</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="n">gens</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GeneratorsError</span><span class="p">(</span>
                    <span class="s">&quot;</span><span class="si">%s</span><span class="s"> doesn&#39;t have </span><span class="si">%s</span><span class="s"> as generator&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gen</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">monom</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">monoms</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">monom</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">indices</span> <span class="ow">and</span> <span class="n">elt</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">False</span>

        <span class="k">return</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="Poly.to_ring"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.to_ring">[docs]</a>    <span class="k">def</span> <span class="nf">to_ring</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make the ground domain a ring.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, QQ</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, domain=QQ).to_ring()</span>
<span class="sd">        Poly(x**2 + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;to_ring&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;to_ring&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.to_field"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.to_field">[docs]</a>    <span class="k">def</span> <span class="nf">to_field</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make the ground domain a field.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, ZZ</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x, domain=ZZ).to_field()</span>
<span class="sd">        Poly(x**2 + 1, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;to_field&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;to_field&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.to_exact"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.to_exact">[docs]</a>    <span class="k">def</span> <span class="nf">to_exact</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make the ground domain exact.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, RR</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1.0, x, domain=RR).to_exact()</span>
<span class="sd">        Poly(x**2 + 1, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;to_exact&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_exact</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;to_exact&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.retract"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.retract">[docs]</a>    <span class="k">def</span> <span class="nf">retract</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recalculate the ground domain of a polynomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x**2 + 1, x, domain=&#39;QQ[y]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f</span>
<span class="sd">        Poly(x**2 + 1, x, domain=&#39;QQ[y]&#39;)</span>

<span class="sd">        &gt;&gt;&gt; f.retract()</span>
<span class="sd">        Poly(x**2 + 1, x, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f.retract(field=True)</span>
<span class="sd">        Poly(x**2 + 1, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">rep</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
            <span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">composite</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">is_Composite</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">dom</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.slice"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.slice">[docs]</a>    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Take a continuous subsequence of terms of ``f``. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">m</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_gen_to_level</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;slice&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;slice&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.coeffs"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.coeffs">[docs]</a>    <span class="k">def</span> <span class="nf">coeffs</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all non-zero coefficients from ``f`` in lex order.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 + 2*x + 3, x).coeffs()</span>
<span class="sd">        [1, 2, 3]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        all_coeffs</span>
<span class="sd">        coeff_monomial</span>
<span class="sd">        nth</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">coeffs</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.monoms"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.monoms">[docs]</a>    <span class="k">def</span> <span class="nf">monoms</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all non-zero monomials from ``f`` in lex order.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 2*x*y**2 + x*y + 3*y, x, y).monoms()</span>
<span class="sd">        [(2, 0), (1, 2), (1, 1), (0, 1)]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        all_monoms</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">monoms</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.terms"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.terms">[docs]</a>    <span class="k">def</span> <span class="nf">terms</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all non-zero terms from ``f`` in lex order.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 2*x*y**2 + x*y + 3*y, x, y).terms()</span>
<span class="sd">        [((2, 0), 1), ((1, 2), 2), ((1, 1), 1), ((0, 1), 3)]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        all_terms</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">terms</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.all_coeffs"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.all_coeffs">[docs]</a>    <span class="k">def</span> <span class="nf">all_coeffs</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all coefficients from a univariate polynomial ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 + 2*x - 1, x).all_coeffs()</span>
<span class="sd">        [1, 0, 2, -1]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">all_coeffs</span><span class="p">()</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.all_monoms"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.all_monoms">[docs]</a>    <span class="k">def</span> <span class="nf">all_monoms</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all monomials from a univariate polynomial ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 + 2*x - 1, x).all_monoms()</span>
<span class="sd">        [(3,), (2,), (1,), (0,)]</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        all_terms</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">all_monoms</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Poly.all_terms"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.all_terms">[docs]</a>    <span class="k">def</span> <span class="nf">all_terms</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all terms from a univariate polynomial ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 + 2*x - 1, x).all_terms()</span>
<span class="sd">        [((3,), 1), ((2,), 0), ((1,), 2), ((0,), -1)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">all_terms</span><span class="p">()</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.termwise"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.termwise">[docs]</a>    <span class="k">def</span> <span class="nf">termwise</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply a function to all terms of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; def func(k, coeff):</span>
<span class="sd">        ...     k = k[0]</span>
<span class="sd">        ...     return coeff//10**(2-k)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 20*x + 400).termwise(func)</span>
<span class="sd">        Poly(x**2 + 2*x + 4, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">monom</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">terms</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">monom</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">monom</span><span class="p">,</span> <span class="n">coeff</span> <span class="o">=</span> <span class="n">result</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coeff</span> <span class="o">=</span> <span class="n">result</span>

            <span class="k">if</span> <span class="n">coeff</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">monom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
                    <span class="n">terms</span><span class="p">[</span><span class="n">monom</span><span class="p">]</span> <span class="o">=</span> <span class="n">coeff</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span>
                        <span class="s">&quot;</span><span class="si">%s</span><span class="s"> monomial was generated twice&quot;</span> <span class="o">%</span> <span class="n">monom</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">gens</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">),</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.length"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.length">[docs]</a>    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of non-zero terms in ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 2*x - 1).length()</span>
<span class="sd">        3</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="Poly.as_dict"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.as_dict">[docs]</a>    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">native</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Switch to a ``dict`` representation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 2*x*y**2 - y, x, y).as_dict()</span>
<span class="sd">        {(0, 1): -1, (1, 2): 2, (2, 0): 1}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">native</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="n">zero</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_sympy_dict</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="n">zero</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.as_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.as_list">[docs]</a>    <span class="k">def</span> <span class="nf">as_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">native</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to a ``list`` representation. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">native</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_sympy_list</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Poly.as_expr"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.as_expr">[docs]</a>    <span class="k">def</span> <span class="nf">as_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a Poly instance to an Expr instance.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x**2 + 2*x*y**2 - y, x, y)</span>

<span class="sd">        &gt;&gt;&gt; f.as_expr()</span>
<span class="sd">        x**2 + 2*x*y**2 - y</span>
<span class="sd">        &gt;&gt;&gt; f.as_expr({x: 5})</span>
<span class="sd">        10*y**2 - y + 25</span>
<span class="sd">        &gt;&gt;&gt; f.as_expr(5, 6)</span>
<span class="sd">        379</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span><span class="p">:</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gens</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">mapping</span> <span class="o">=</span> <span class="n">gens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">gen</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">GeneratorsError</span><span class="p">(</span>
                        <span class="s">&quot;</span><span class="si">%s</span><span class="s"> doesn&#39;t have </span><span class="si">%s</span><span class="s"> as generator&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gen</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gens</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">basic_from_dict</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_sympy_dict</span><span class="p">(),</span> <span class="o">*</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.lift"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.lift">[docs]</a>    <span class="k">def</span> <span class="nf">lift</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert algebraic coefficients to rationals.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, I</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + I*x + 1, x, extension=I).lift()</span>
<span class="sd">        Poly(x**4 + 3*x**2 + 1, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;lift&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;lift&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.deflate"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.deflate">[docs]</a>    <span class="k">def</span> <span class="nf">deflate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduce degree of ``f`` by mapping ``x_i**m`` to ``y_i``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**6*y**2 + x**3 + 1, x, y).deflate()</span>
<span class="sd">        ((3, 2), Poly(x**2*y + x + 1, x, y, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;deflate&#39;</span><span class="p">):</span>
            <span class="n">J</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">deflate</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;deflate&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">J</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.inject"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.inject">[docs]</a>    <span class="k">def</span> <span class="nf">inject</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">front</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inject ground domain generators into ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x**2*y + x*y**3 + x*y + 1, x)</span>

<span class="sd">        &gt;&gt;&gt; f.inject()</span>
<span class="sd">        Poly(x**2*y + x*y**3 + x*y + 1, x, y, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f.inject(front=True)</span>
<span class="sd">        Poly(y**3*x + y*x**2 + y*x + 1, y, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span>

        <span class="k">if</span> <span class="n">dom</span><span class="o">.</span><span class="n">is_Numerical</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">dom</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainError</span><span class="p">(</span><span class="s">&quot;can&#39;t inject generators over </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">dom</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;inject&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">front</span><span class="o">=</span><span class="n">front</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;inject&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">front</span><span class="p">:</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">symbols</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span> <span class="o">+</span> <span class="n">dom</span><span class="o">.</span><span class="n">symbols</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.eject"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.eject">[docs]</a>    <span class="k">def</span> <span class="nf">eject</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Eject selected generators into the ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x**2*y + x*y**3 + x*y + 1, x, y)</span>

<span class="sd">        &gt;&gt;&gt; f.eject(x)</span>
<span class="sd">        Poly(x*y**3 + (x**2 + x)*y + 1, y, domain=&#39;ZZ[x]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f.eject(y)</span>
<span class="sd">        Poly(y*x**2 + (y**3 + y)*x + 1, x, domain=&#39;ZZ[y]&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">dom</span><span class="o">.</span><span class="n">is_Numerical</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainError</span><span class="p">(</span><span class="s">&quot;can&#39;t eject generators over </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">dom</span><span class="p">)</span>

        <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">gens</span><span class="p">:</span>
            <span class="n">_gens</span><span class="p">,</span> <span class="n">front</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="n">k</span><span class="p">:],</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="p">:]</span> <span class="o">==</span> <span class="n">gens</span><span class="p">:</span>
            <span class="n">_gens</span><span class="p">,</span> <span class="n">front</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[:</span><span class="o">-</span><span class="n">k</span><span class="p">],</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s">&quot;can only eject front or back generators&quot;</span><span class="p">)</span>

        <span class="n">dom</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="o">*</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;eject&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">eject</span><span class="p">(</span><span class="n">dom</span><span class="p">,</span> <span class="n">front</span><span class="o">=</span><span class="n">front</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;eject&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="o">*</span><span class="n">_gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.terms_gcd"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.terms_gcd">[docs]</a>    <span class="k">def</span> <span class="nf">terms_gcd</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove GCD of terms from the polynomial ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**6*y**2 + x**3*y, x, y).terms_gcd()</span>
<span class="sd">        ((3, 1), Poly(x**3*y + 1, x, y, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;terms_gcd&#39;</span><span class="p">):</span>
            <span class="n">J</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">terms_gcd</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;terms_gcd&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">J</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.add_ground"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.add_ground">[docs]</a>    <span class="k">def</span> <span class="nf">add_ground</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an element of the ground domain to ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x + 1).add_ground(2)</span>
<span class="sd">        Poly(x + 3, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;add_ground&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">add_ground</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;add_ground&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.sub_ground"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.sub_ground">[docs]</a>    <span class="k">def</span> <span class="nf">sub_ground</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subtract an element of the ground domain from ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x + 1).sub_ground(2)</span>
<span class="sd">        Poly(x - 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;sub_ground&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">sub_ground</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;sub_ground&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.mul_ground"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.mul_ground">[docs]</a>    <span class="k">def</span> <span class="nf">mul_ground</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Multiply ``f`` by a an element of the ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x + 1).mul_ground(2)</span>
<span class="sd">        Poly(2*x + 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;mul_ground&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">mul_ground</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;mul_ground&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.quo_ground"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.quo_ground">[docs]</a>    <span class="k">def</span> <span class="nf">quo_ground</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quotient of ``f`` by a an element of the ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x + 4).quo_ground(2)</span>
<span class="sd">        Poly(x + 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x + 3).quo_ground(2)</span>
<span class="sd">        Poly(x + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;quo_ground&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">quo_ground</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;quo_ground&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.exquo_ground"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.exquo_ground">[docs]</a>    <span class="k">def</span> <span class="nf">exquo_ground</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exact quotient of ``f`` by a an element of the ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x + 4).exquo_ground(2)</span>
<span class="sd">        Poly(x + 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x + 3).exquo_ground(2)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ExactQuotientFailed: 2 does not divide 3 in ZZ</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;exquo_ground&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">exquo_ground</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;exquo_ground&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.abs"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.abs">[docs]</a>    <span class="k">def</span> <span class="nf">abs</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make all coefficients in ``f`` positive.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).abs()</span>
<span class="sd">        Poly(x**2 + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;abs&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;abs&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.neg"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.neg">[docs]</a>    <span class="k">def</span> <span class="nf">neg</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Negate all coefficients in ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).neg()</span>
<span class="sd">        Poly(-x**2 + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; -Poly(x**2 - 1, x)</span>
<span class="sd">        Poly(-x**2 + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;neg&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">neg</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;neg&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.add"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add two polynomials ``f`` and ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).add(Poly(x - 2, x))</span>
<span class="sd">        Poly(x**2 + x - 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x) + Poly(x - 2, x)</span>
<span class="sd">        Poly(x**2 + x - 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">add_ground</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;add&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;add&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.sub"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.sub">[docs]</a>    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subtract two polynomials ``f`` and ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).sub(Poly(x - 2, x))</span>
<span class="sd">        Poly(x**2 - x + 3, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x) - Poly(x - 2, x)</span>
<span class="sd">        Poly(x**2 - x + 3, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">sub_ground</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;sub&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;sub&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.mul"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.mul">[docs]</a>    <span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Multiply two polynomials ``f`` and ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).mul(Poly(x - 2, x))</span>
<span class="sd">        Poly(x**3 - 2*x**2 + x - 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x)*Poly(x - 2, x)</span>
<span class="sd">        Poly(x**3 - 2*x**2 + x - 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">mul_ground</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;mul&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;mul&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.sqr"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.sqr">[docs]</a>    <span class="k">def</span> <span class="nf">sqr</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Square a polynomial ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x - 2, x).sqr()</span>
<span class="sd">        Poly(x**2 - 4*x + 4, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x - 2, x)**2</span>
<span class="sd">        Poly(x**2 - 4*x + 4, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;sqr&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">sqr</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;sqr&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.pow"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.pow">[docs]</a>    <span class="k">def</span> <span class="nf">pow</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Raise ``f`` to a non-negative power ``n``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x - 2, x).pow(3)</span>
<span class="sd">        Poly(x**3 - 6*x**2 + 12*x - 8, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x - 2, x)**3</span>
<span class="sd">        Poly(x**3 - 6*x**2 + 12*x - 8, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;pow&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;pow&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.pdiv"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.pdiv">[docs]</a>    <span class="k">def</span> <span class="nf">pdiv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polynomial pseudo-division of ``f`` by ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).pdiv(Poly(2*x - 4, x))</span>
<span class="sd">        (Poly(2*x + 4, x, domain=&#39;ZZ&#39;), Poly(20, x, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;pdiv&#39;</span><span class="p">):</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pdiv</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;pdiv&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.prem"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.prem">[docs]</a>    <span class="k">def</span> <span class="nf">prem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polynomial pseudo-remainder of ``f`` by ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).prem(Poly(2*x - 4, x))</span>
<span class="sd">        Poly(20, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;prem&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">prem</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;prem&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.pquo"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.pquo">[docs]</a>    <span class="k">def</span> <span class="nf">pquo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polynomial pseudo-quotient of ``f`` by ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).pquo(Poly(2*x - 4, x))</span>
<span class="sd">        Poly(2*x + 4, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).pquo(Poly(2*x - 2, x))</span>
<span class="sd">        Poly(2*x + 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;pquo&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pquo</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;pquo&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.pexquo"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.pexquo">[docs]</a>    <span class="k">def</span> <span class="nf">pexquo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polynomial exact pseudo-quotient of ``f`` by ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).pexquo(Poly(2*x - 2, x))</span>
<span class="sd">        Poly(2*x + 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).pexquo(Poly(2*x - 4, x))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ExactQuotientFailed: 2*x - 4 does not divide x**2 + 1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;pexquo&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pexquo</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ExactQuotientFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">exc</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;pexquo&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.div"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.div">[docs]</a>    <span class="k">def</span> <span class="nf">div</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polynomial division with remainder of ``f`` by ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).div(Poly(2*x - 4, x))</span>
<span class="sd">        (Poly(1/2*x + 1, x, domain=&#39;QQ&#39;), Poly(5, x, domain=&#39;QQ&#39;))</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).div(Poly(2*x - 4, x), auto=False)</span>
<span class="sd">        (Poly(0, x, domain=&#39;ZZ&#39;), Poly(x**2 + 1, x, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="n">retract</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">to_field</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>
            <span class="n">retract</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;div&#39;</span><span class="p">):</span>
            <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;div&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">retract</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">to_ring</span><span class="p">(),</span> <span class="n">r</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">Q</span><span class="p">,</span> <span class="n">R</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.rem"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.rem">[docs]</a>    <span class="k">def</span> <span class="nf">rem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the polynomial remainder of ``f`` by ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, ZZ, QQ</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).rem(Poly(2*x - 4, x))</span>
<span class="sd">        Poly(5, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).rem(Poly(2*x - 4, x), auto=False)</span>
<span class="sd">        Poly(x**2 + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="n">retract</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">to_field</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>
            <span class="n">retract</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;rem&#39;</span><span class="p">):</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">rem</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;rem&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">retract</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.quo"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.quo">[docs]</a>    <span class="k">def</span> <span class="nf">quo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes polynomial quotient of ``f`` by ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).quo(Poly(2*x - 4, x))</span>
<span class="sd">        Poly(1/2*x + 1, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).quo(Poly(x - 1, x))</span>
<span class="sd">        Poly(x + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="n">retract</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">to_field</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>
            <span class="n">retract</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;quo&#39;</span><span class="p">):</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">quo</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;quo&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">retract</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.exquo"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.exquo">[docs]</a>    <span class="k">def</span> <span class="nf">exquo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes polynomial exact quotient of ``f`` by ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).exquo(Poly(x - 1, x))</span>
<span class="sd">        Poly(x + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).exquo(Poly(2*x - 4, x))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ExactQuotientFailed: 2*x - 4 does not divide x**2 + 1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="n">retract</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">to_field</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>
            <span class="n">retract</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;exquo&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">exquo</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ExactQuotientFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">exc</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;exquo&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">retract</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_gen_to_level</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gen</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns level associated with the given generator. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

            <span class="k">if</span> <span class="o">-</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="n">gen</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">gen</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">length</span> <span class="o">+</span> <span class="n">gen</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">gen</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;-</span><span class="si">%s</span><span class="s"> &lt;= gen &lt; </span><span class="si">%s</span><span class="s"> expected, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                                      <span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">gen</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span>
                    <span class="s">&quot;a valid generator expected, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">gen</span><span class="p">)</span>

<div class="viewcode-block" id="Poly.degree"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.degree">[docs]</a>    <span class="k">def</span> <span class="nf">degree</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns degree of ``f`` in ``x_j``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + y*x + 1, x, y).degree()</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + y*x + y, x, y).degree(y)</span>
<span class="sd">        1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_gen_to_level</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;degree&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;degree&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.degree_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.degree_list">[docs]</a>    <span class="k">def</span> <span class="nf">degree_list</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of degrees of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + y*x + 1, x, y).degree_list()</span>
<span class="sd">        (2, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;degree_list&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">degree_list</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;degree_list&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.total_degree"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.total_degree">[docs]</a>    <span class="k">def</span> <span class="nf">total_degree</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the total degree of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + y*x + 1, x, y).total_degree()</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; Poly(x + y**5, x, y).total_degree()</span>
<span class="sd">        5</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;total_degree&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">total_degree</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;total_degree&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.homogeneous_order"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.homogeneous_order">[docs]</a>    <span class="k">def</span> <span class="nf">homogeneous_order</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the homogeneous order of ``f``.</span>

<span class="sd">        A homogeneous polynomial is a polynomial whose all monomials with</span>
<span class="sd">        non-zero coefficients have the same total degree. This degree is</span>
<span class="sd">        the homogeneous order of ``f``. If you only want to check if a</span>
<span class="sd">        polynomial is homogeneous, then use :func:`Poly.is_homogeneous`.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x**5 + 2*x**3*y**2 + 9*x*y**4)</span>
<span class="sd">        &gt;&gt;&gt; f.homogeneous_order()</span>
<span class="sd">        5</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;homogeneous_order&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">homogeneous_order</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;homogeneous_order&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.LC"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.LC">[docs]</a>    <span class="k">def</span> <span class="nf">LC</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the leading coefficient of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(4*x**3 + 2*x**2 + 3*x, x).LC()</span>
<span class="sd">        4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">coeffs</span><span class="p">(</span><span class="n">order</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;LC&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">LC</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;LC&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.TC"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.TC">[docs]</a>    <span class="k">def</span> <span class="nf">TC</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the trailing coefficient of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 + 2*x**2 + 3*x, x).TC()</span>
<span class="sd">        0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;TC&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">TC</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;TC&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.EC"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.EC">[docs]</a>    <span class="k">def</span> <span class="nf">EC</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the last non-zero coefficient of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 + 2*x**2 + 3*x, x).EC()</span>
<span class="sd">        3</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;coeffs&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">coeffs</span><span class="p">(</span><span class="n">order</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;EC&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.coeff_monomial"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.coeff_monomial">[docs]</a>    <span class="k">def</span> <span class="nf">coeff_monomial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">monom</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the coefficient of ``monom`` in ``f`` if there, else None.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, exp</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; p = Poly(24*x*y*exp(8) + 23*x, x, y)</span>

<span class="sd">        &gt;&gt;&gt; p.coeff_monomial(x)</span>
<span class="sd">        23</span>
<span class="sd">        &gt;&gt;&gt; p.coeff_monomial(y)</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; p.coeff_monomial(x*y)</span>
<span class="sd">        24*exp(8)</span>

<span class="sd">        Note that ``Expr.coeff()`` behaves differently, collecting terms</span>
<span class="sd">        if possible; the Poly must be converted to an Expr to use that</span>
<span class="sd">        method, however:</span>

<span class="sd">        &gt;&gt;&gt; p.as_expr().coeff(x)</span>
<span class="sd">        24*y*exp(8) + 23</span>
<span class="sd">        &gt;&gt;&gt; p.as_expr().coeff(y)</span>
<span class="sd">        24*x*exp(8)</span>
<span class="sd">        &gt;&gt;&gt; p.as_expr().coeff(x*y)</span>
<span class="sd">        24*exp(8)</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        nth: more efficient query using exponents of the monomial&#39;s generators</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="o">*</span><span class="n">Monomial</span><span class="p">(</span><span class="n">monom</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span><span class="o">.</span><span class="n">exponents</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.nth"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.nth">[docs]</a>    <span class="k">def</span> <span class="nf">nth</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">N</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the ``n``-th coefficient of ``f`` where ``N`` are the</span>
<span class="sd">        exponents of the generators in the term of interest.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, sqrt</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 + 2*x**2 + 3*x, x).nth(2)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**3 + 2*x*y**2 + y**2, x, y).nth(1, 2)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; Poly(4*sqrt(x)*y)</span>
<span class="sd">        Poly(4*y*sqrt(x), y, sqrt(x), domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; _.nth(1, 1)</span>
<span class="sd">        4</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        coeff_monomial</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;nth&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">N</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;nth&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">coeff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c"># the semantics of coeff_monomial and Expr.coeff are different;</span>
        <span class="c"># if someone is working with a Poly, they should be aware of the</span>
        <span class="c"># differences and chose the method best suited for the query.</span>
        <span class="c"># Alternatively, a pure-polys method could be written here but</span>
        <span class="c"># at this time the ``right`` keyword would be ignored because Poly</span>
        <span class="c"># doesn&#39;t work with non-commutatives.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s">&#39;Either convert to Expr with `as_expr` method &#39;</span>
            <span class="s">&#39;to use Expr</span><span class="se">\&#39;</span><span class="s">s coeff method or else use the &#39;</span>
            <span class="s">&#39;`coeff_monomial` method of Polys.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Poly.LM"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.LM">[docs]</a>    <span class="k">def</span> <span class="nf">LM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the leading monomial of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(4*x**2 + 2*x*y**2 + x*y + 3*y, x, y).LM()</span>
<span class="sd">        x**2*y**0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Monomial</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">monoms</span><span class="p">(</span><span class="n">order</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.EM"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.EM">[docs]</a>    <span class="k">def</span> <span class="nf">EM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the last non-zero monomial of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(4*x**2 + 2*x*y**2 + x*y + 3*y, x, y).EM()</span>
<span class="sd">        x**0*y**1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Monomial</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">monoms</span><span class="p">(</span><span class="n">order</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.LT"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.LT">[docs]</a>    <span class="k">def</span> <span class="nf">LT</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the leading term of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(4*x**2 + 2*x*y**2 + x*y + 3*y, x, y).LT()</span>
<span class="sd">        (x**2*y**0, 4)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">monom</span><span class="p">,</span> <span class="n">coeff</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">terms</span><span class="p">(</span><span class="n">order</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Monomial</span><span class="p">(</span><span class="n">monom</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">),</span> <span class="n">coeff</span>
</div>
<div class="viewcode-block" id="Poly.ET"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.ET">[docs]</a>    <span class="k">def</span> <span class="nf">ET</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the last non-zero term of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(4*x**2 + 2*x*y**2 + x*y + 3*y, x, y).ET()</span>
<span class="sd">        (x**0*y**1, 3)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">monom</span><span class="p">,</span> <span class="n">coeff</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">terms</span><span class="p">(</span><span class="n">order</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Monomial</span><span class="p">(</span><span class="n">monom</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">),</span> <span class="n">coeff</span>
</div>
<div class="viewcode-block" id="Poly.max_norm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.max_norm">[docs]</a>    <span class="k">def</span> <span class="nf">max_norm</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns maximum norm of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(-x**2 + 2*x - 3, x).max_norm()</span>
<span class="sd">        3</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;max_norm&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">max_norm</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;max_norm&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.l1_norm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.l1_norm">[docs]</a>    <span class="k">def</span> <span class="nf">l1_norm</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns l1 norm of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(-x**2 + 2*x - 3, x).l1_norm()</span>
<span class="sd">        6</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;l1_norm&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">l1_norm</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;l1_norm&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.clear_denoms"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.clear_denoms">[docs]</a>    <span class="k">def</span> <span class="nf">clear_denoms</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear denominators, but keep the ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, S, QQ</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x/2 + S(1)/3, x, domain=QQ)</span>

<span class="sd">        &gt;&gt;&gt; f.clear_denoms()</span>
<span class="sd">        (6, Poly(3*x + 2, x, domain=&#39;QQ&#39;))</span>
<span class="sd">        &gt;&gt;&gt; f.clear_denoms(convert=True)</span>
<span class="sd">        (6, Poly(3*x + 2, x, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="n">f</span>

        <span class="n">dom</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_assoc_Ring</span><span class="p">:</span>
            <span class="n">dom</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">get_ring</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;clear_denoms&#39;</span><span class="p">):</span>
            <span class="n">coeff</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">clear_denoms</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;clear_denoms&#39;</span><span class="p">)</span>

        <span class="n">coeff</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">coeff</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">convert</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_assoc_Ring</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">f</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Poly.rat_clear_denoms"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.rat_clear_denoms">[docs]</a>    <span class="k">def</span> <span class="nf">rat_clear_denoms</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear denominators in a rational function ``f/g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x**2/y + 1, x)</span>
<span class="sd">        &gt;&gt;&gt; g = Poly(x**3 + y, x)</span>

<span class="sd">        &gt;&gt;&gt; p, q = f.rat_clear_denoms(g)</span>

<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        Poly(x**2 + y, x, domain=&#39;ZZ[y]&#39;)</span>
<span class="sd">        &gt;&gt;&gt; q</span>
<span class="sd">        Poly(y*x**3 + y**2, x, domain=&#39;ZZ[y]&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">per</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">per</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dom</span><span class="o">.</span><span class="n">has_Field</span> <span class="ow">and</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_assoc_Ring</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span>

        <span class="n">a</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">clear_denoms</span><span class="p">(</span><span class="n">convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">clear_denoms</span><span class="p">(</span><span class="n">convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">mul_ground</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">mul_ground</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span>
</div>
<div class="viewcode-block" id="Poly.integrate"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.integrate">[docs]</a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">specs</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes indefinite integral of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 2*x + 1, x).integrate()</span>
<span class="sd">        Poly(1/3*x**3 + x**2 + x, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x*y**2 + x, x, y).integrate((0, 1), (1, 0))</span>
<span class="sd">        Poly(1/2*x**2*y**2 + 1/2*x**2, x, y, domain=&#39;QQ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;integrate&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">specs</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

            <span class="n">rep</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span>

            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                    <span class="n">gen</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">spec</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gen</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">spec</span><span class="p">,</span> <span class="mi">1</span>

                <span class="n">rep</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">_gen_to_level</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;integrate&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.diff"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.diff">[docs]</a>    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">specs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes partial derivative of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 2*x + 1, x).diff()</span>
<span class="sd">        Poly(2*x + 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x*y**2 + x, x, y).diff((0, 0), (1, 1))</span>
<span class="sd">        Poly(2*x*y, x, y, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;diff&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">specs</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

            <span class="n">rep</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span>

            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                    <span class="n">gen</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">spec</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gen</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">spec</span><span class="p">,</span> <span class="mi">1</span>

                <span class="n">rep</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">_gen_to_level</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;diff&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.eval"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.eval">[docs]</a>    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate ``f`` at ``a`` in the given variable.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 2*x + 3, x).eval(2)</span>
<span class="sd">        11</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x*y + 3*x + y + 2, x, y).eval(x, 2)</span>
<span class="sd">        Poly(5*y + 8, y, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(2*x*y + 3*x + y + 2*z, x, y, z)</span>

<span class="sd">        &gt;&gt;&gt; f.eval({x: 2})</span>
<span class="sd">        Poly(5*y + 2*z + 6, y, z, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f.eval({x: 2, y: 5})</span>
<span class="sd">        Poly(2*z + 31, z, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f.eval({x: 2, y: 5, z: 7})</span>
<span class="sd">        45</span>

<span class="sd">        &gt;&gt;&gt; f.eval((2, 5))</span>
<span class="sd">        Poly(2*z + 31, z, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f(2, 5)</span>
<span class="sd">        Poly(2*z + 31, z, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">mapping</span> <span class="o">=</span> <span class="n">x</span>

                <span class="k">for</span> <span class="n">gen</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">f</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">x</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;too many values provided&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">gen</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">f</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">j</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_gen_to_level</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;eval&#39;</span><span class="p">):</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;eval&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">auto</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DomainError</span><span class="p">(</span><span class="s">&quot;can&#39;t evaluate at </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">a_domain</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">([</span><span class="n">a</span><span class="p">])</span>
                <span class="n">new_domain</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span><span class="o">.</span><span class="n">unify_with_symbols</span><span class="p">(</span><span class="n">a_domain</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

                <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">new_domain</span><span class="p">)</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">new_domain</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a_domain</span><span class="p">)</span>

                <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate ``f`` at the give values.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(2*x*y + 3*x + y + 2*z, x, y, z)</span>

<span class="sd">        &gt;&gt;&gt; f(2)</span>
<span class="sd">        Poly(5*y + 2*z + 6, y, z, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f(2, 5)</span>
<span class="sd">        Poly(2*z + 31, z, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f(2, 5, 7)</span>
<span class="sd">        45</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

<div class="viewcode-block" id="Poly.half_gcdex"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.half_gcdex">[docs]</a>    <span class="k">def</span> <span class="nf">half_gcdex</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Half extended Euclidean algorithm of ``f`` and ``g``.</span>

<span class="sd">        Returns ``(s, h)`` such that ``h = gcd(f, g)`` and ``s*f = h (mod g)``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = x**4 - 2*x**3 - 6*x**2 + 12*x + 15</span>
<span class="sd">        &gt;&gt;&gt; g = x**3 + x**2 - 4*x - 4</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).half_gcdex(Poly(g))</span>
<span class="sd">        (Poly(-1/5*x + 3/5, x, domain=&#39;QQ&#39;), Poly(x + 1, x, domain=&#39;QQ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span><span class="p">:</span>
            <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">to_field</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;half_gcdex&#39;</span><span class="p">):</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">half_gcdex</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;half_gcdex&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.gcdex"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.gcdex">[docs]</a>    <span class="k">def</span> <span class="nf">gcdex</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extended Euclidean algorithm of ``f`` and ``g``.</span>

<span class="sd">        Returns ``(s, t, h)`` such that ``h = gcd(f, g)`` and ``s*f + t*g = h``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = x**4 - 2*x**3 - 6*x**2 + 12*x + 15</span>
<span class="sd">        &gt;&gt;&gt; g = x**3 + x**2 - 4*x - 4</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).gcdex(Poly(g))</span>
<span class="sd">        (Poly(-1/5*x + 3/5, x, domain=&#39;QQ&#39;),</span>
<span class="sd">         Poly(1/5*x**2 - 6/5*x + 2, x, domain=&#39;QQ&#39;),</span>
<span class="sd">         Poly(x + 1, x, domain=&#39;QQ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span><span class="p">:</span>
            <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">to_field</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;gcdex&#39;</span><span class="p">):</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gcdex</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;gcdex&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.invert"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.invert">[docs]</a>    <span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invert ``f`` modulo ``g`` when possible.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).invert(Poly(2*x - 1, x))</span>
<span class="sd">        Poly(-4/3, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).invert(Poly(x - 1, x))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        NotInvertible: zero divisor</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span><span class="p">:</span>
            <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">to_field</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;invert&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;invert&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.revert"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.revert">[docs]</a>    <span class="k">def</span> <span class="nf">revert</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute ``f**(-1)`` mod ``x**n``. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;revert&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">revert</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;revert&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.subresultants"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.subresultants">[docs]</a>    <span class="k">def</span> <span class="nf">subresultants</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the subresultant PRS of ``f`` and ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x).subresultants(Poly(x**2 - 1, x))</span>
<span class="sd">        [Poly(x**2 + 1, x, domain=&#39;ZZ&#39;),</span>
<span class="sd">         Poly(x**2 - 1, x, domain=&#39;ZZ&#39;),</span>
<span class="sd">         Poly(-2, x, domain=&#39;ZZ&#39;)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;subresultants&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">subresultants</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;subresultants&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">per</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Poly.resultant"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.resultant">[docs]</a>    <span class="k">def</span> <span class="nf">resultant</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">includePRS</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the resultant of ``f`` and ``g`` via PRS.</span>

<span class="sd">        If includePRS=True, it includes the subresultant PRS in the result.</span>
<span class="sd">        Because the PRS is used to calculate the resultant, this is more</span>
<span class="sd">        efficient than calling :func:`subresultants` separately.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x**2 + 1, x)</span>

<span class="sd">        &gt;&gt;&gt; f.resultant(Poly(x**2 - 1, x))</span>
<span class="sd">        4</span>
<span class="sd">        &gt;&gt;&gt; f.resultant(Poly(x**2 - 1, x), includePRS=True)</span>
<span class="sd">        (4, [Poly(x**2 + 1, x, domain=&#39;ZZ&#39;), Poly(x**2 - 1, x, domain=&#39;ZZ&#39;),</span>
<span class="sd">             Poly(-2, x, domain=&#39;ZZ&#39;)])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;resultant&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">includePRS</span><span class="p">:</span>
                <span class="n">result</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">includePRS</span><span class="o">=</span><span class="n">includePRS</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;resultant&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">includePRS</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">per</span><span class="p">,</span> <span class="n">R</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.discriminant"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.discriminant">[docs]</a>    <span class="k">def</span> <span class="nf">discriminant</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the discriminant of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 2*x + 3, x).discriminant()</span>
<span class="sd">        -8</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;discriminant&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;discriminant&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.cofactors"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.cofactors">[docs]</a>    <span class="k">def</span> <span class="nf">cofactors</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the GCD of ``f`` and ``g`` and their cofactors.</span>

<span class="sd">        Returns polynomials ``(h, cff, cfg)`` such that ``h = gcd(f, g)``, and</span>
<span class="sd">        ``cff = quo(f, h)`` and ``cfg = quo(g, h)`` are, so called, cofactors</span>
<span class="sd">        of ``f`` and ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).cofactors(Poly(x**2 - 3*x + 2, x))</span>
<span class="sd">        (Poly(x - 1, x, domain=&#39;ZZ&#39;),</span>
<span class="sd">         Poly(x + 1, x, domain=&#39;ZZ&#39;),</span>
<span class="sd">         Poly(x - 2, x, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;cofactors&#39;</span><span class="p">):</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">cff</span><span class="p">,</span> <span class="n">cfg</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cofactors</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;cofactors&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">cff</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.gcd"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.gcd">[docs]</a>    <span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the polynomial GCD of ``f`` and ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).gcd(Poly(x**2 - 3*x + 2, x))</span>
<span class="sd">        Poly(x - 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;gcd&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;gcd&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.lcm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.lcm">[docs]</a>    <span class="k">def</span> <span class="nf">lcm</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns polynomial LCM of ``f`` and ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).lcm(Poly(x**2 - 3*x + 2, x))</span>
<span class="sd">        Poly(x**3 - 2*x**2 - x + 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;lcm&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;lcm&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.trunc"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.trunc">[docs]</a>    <span class="k">def</span> <span class="nf">trunc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduce ``f`` modulo a constant ``p``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x**3 + 3*x**2 + 5*x + 7, x).trunc(3)</span>
<span class="sd">        Poly(-x**3 - x + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;trunc&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;trunc&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.monic"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.monic">[docs]</a>    <span class="k">def</span> <span class="nf">monic</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divides all coefficients by ``LC(f)``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, ZZ</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(3*x**2 + 6*x + 9, x, domain=ZZ).monic()</span>
<span class="sd">        Poly(x**2 + 2*x + 3, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &gt;&gt;&gt; Poly(3*x**2 + 4*x + 2, x, domain=ZZ).monic()</span>
<span class="sd">        Poly(x**2 + 4/3*x + 2/3, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;monic&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;monic&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.content"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.content">[docs]</a>    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the GCD of polynomial coefficients.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(6*x**2 + 8*x + 12, x).content()</span>
<span class="sd">        2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;content&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;content&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.primitive"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.primitive">[docs]</a>    <span class="k">def</span> <span class="nf">primitive</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the content and a primitive form of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x**2 + 8*x + 12, x).primitive()</span>
<span class="sd">        (2, Poly(x**2 + 4*x + 6, x, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;primitive&#39;</span><span class="p">):</span>
            <span class="n">cont</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;primitive&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">cont</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.compose"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.compose">[docs]</a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the functional composition of ``f`` and ``g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + x, x).compose(Poly(x - 1, x))</span>
<span class="sd">        Poly(x**2 - x, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;compose&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;compose&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.decompose"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.decompose">[docs]</a>    <span class="k">def</span> <span class="nf">decompose</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a functional decomposition of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**4 + 2*x**3 - x - 1, x, domain=&#39;ZZ&#39;).decompose()</span>
<span class="sd">        [Poly(x**2 - x - 1, x, domain=&#39;ZZ&#39;), Poly(x**2 + x, x, domain=&#39;ZZ&#39;)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;decompose&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;decompose&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Poly.shift"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Efficiently compute Taylor shift ``f(x + a)``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 2*x + 1, x).shift(2)</span>
<span class="sd">        Poly(x**2 + 2*x + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;shift&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;shift&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.sturm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.sturm">[docs]</a>    <span class="k">def</span> <span class="nf">sturm</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Sturm sequence of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 - 2*x**2 + x - 3, x).sturm()</span>
<span class="sd">        [Poly(x**3 - 2*x**2 + x - 3, x, domain=&#39;QQ&#39;),</span>
<span class="sd">         Poly(3*x**2 - 4*x + 1, x, domain=&#39;QQ&#39;),</span>
<span class="sd">         Poly(2/9*x + 25/9, x, domain=&#39;QQ&#39;),</span>
<span class="sd">         Poly(-2079/4, x, domain=&#39;QQ&#39;)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">has_Ring</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">to_field</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;sturm&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">sturm</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;sturm&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Poly.gff_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.gff_list">[docs]</a>    <span class="k">def</span> <span class="nf">gff_list</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes greatest factorial factorization of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = x**5 + 2*x**4 - x**3 - 2*x**2</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).gff_list()</span>
<span class="sd">        [(Poly(x, x, domain=&#39;ZZ&#39;), 1), (Poly(x + 2, x, domain=&#39;ZZ&#39;), 4)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;gff_list&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">gff_list</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;gff_list&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">result</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.sqf_norm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.sqf_norm">[docs]</a>    <span class="k">def</span> <span class="nf">sqf_norm</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes square-free norm of ``f``.</span>

<span class="sd">        Returns ``s``, ``f``, ``r``, such that ``g(x) = f(x-sa)`` and</span>
<span class="sd">        ``r(x) = Norm(g(x))`` is a square-free polynomial over ``K``,</span>
<span class="sd">        where ``a`` is the algebraic extension of the ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, sqrt</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; s, f, r = Poly(x**2 + 1, x, extension=[sqrt(3)]).sqf_norm()</span>

<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; f</span>
<span class="sd">        Poly(x**2 - 2*sqrt(3)*x + 4, x, domain=&#39;QQ&lt;sqrt(3)&gt;&#39;)</span>
<span class="sd">        &gt;&gt;&gt; r</span>
<span class="sd">        Poly(x**4 - 4*x**2 + 16, x, domain=&#39;QQ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;sqf_norm&#39;</span><span class="p">):</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">sqf_norm</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;sqf_norm&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.sqf_part"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.sqf_part">[docs]</a>    <span class="k">def</span> <span class="nf">sqf_part</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes square-free part of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**3 - 3*x - 2, x).sqf_part()</span>
<span class="sd">        Poly(x**2 - x - 2, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;sqf_part&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">sqf_part</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;sqf_part&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.sqf_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.sqf_list">[docs]</a>    <span class="k">def</span> <span class="nf">sqf_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of square-free factors of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = 2*x**5 + 16*x**4 + 50*x**3 + 76*x**2 + 56*x + 16</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).sqf_list()</span>
<span class="sd">        (2, [(Poly(x + 1, x, domain=&#39;ZZ&#39;), 2),</span>
<span class="sd">             (Poly(x + 2, x, domain=&#39;ZZ&#39;), 3)])</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).sqf_list(all=True)</span>
<span class="sd">        (2, [(Poly(1, x, domain=&#39;ZZ&#39;), 1),</span>
<span class="sd">             (Poly(x + 1, x, domain=&#39;ZZ&#39;), 2),</span>
<span class="sd">             (Poly(x + 2, x, domain=&#39;ZZ&#39;), 3)])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;sqf_list&#39;</span><span class="p">):</span>
            <span class="n">coeff</span><span class="p">,</span> <span class="n">factors</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">sqf_list</span><span class="p">(</span><span class="nb">all</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;sqf_list&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">coeff</span><span class="p">),</span> <span class="p">[</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">factors</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.sqf_list_include"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.sqf_list_include">[docs]</a>    <span class="k">def</span> <span class="nf">sqf_list_include</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of square-free factors of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, expand</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = expand(2*(x + 1)**3*x**4)</span>
<span class="sd">        &gt;&gt;&gt; f</span>
<span class="sd">        2*x**7 + 6*x**6 + 6*x**5 + 2*x**4</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).sqf_list_include()</span>
<span class="sd">        [(Poly(2, x, domain=&#39;ZZ&#39;), 1),</span>
<span class="sd">         (Poly(x + 1, x, domain=&#39;ZZ&#39;), 3),</span>
<span class="sd">         (Poly(x, x, domain=&#39;ZZ&#39;), 4)]</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).sqf_list_include(all=True)</span>
<span class="sd">        [(Poly(2, x, domain=&#39;ZZ&#39;), 1),</span>
<span class="sd">         (Poly(1, x, domain=&#39;ZZ&#39;), 2),</span>
<span class="sd">         (Poly(x + 1, x, domain=&#39;ZZ&#39;), 3),</span>
<span class="sd">         (Poly(x, x, domain=&#39;ZZ&#39;), 4)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;sqf_list_include&#39;</span><span class="p">):</span>
            <span class="n">factors</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">sqf_list_include</span><span class="p">(</span><span class="nb">all</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;sqf_list_include&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">factors</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.factor_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.factor_list">[docs]</a>    <span class="k">def</span> <span class="nf">factor_list</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of irreducible factors of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = 2*x**5 + 2*x**4*y + 4*x**3 + 4*x**2*y + 2*x + 2*y</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).factor_list()</span>
<span class="sd">        (2, [(Poly(x + y, x, y, domain=&#39;ZZ&#39;), 1),</span>
<span class="sd">             (Poly(x**2 + 1, x, y, domain=&#39;ZZ&#39;), 2)])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;factor_list&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">coeff</span><span class="p">,</span> <span class="n">factors</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">factor_list</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">DomainError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="p">[(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;factor_list&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">coeff</span><span class="p">),</span> <span class="p">[</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">factors</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.factor_list_include"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.factor_list_include">[docs]</a>    <span class="k">def</span> <span class="nf">factor_list_include</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of irreducible factors of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = 2*x**5 + 2*x**4*y + 4*x**3 + 4*x**2*y + 2*x + 2*y</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).factor_list_include()</span>
<span class="sd">        [(Poly(2*x + 2*y, x, y, domain=&#39;ZZ&#39;), 1),</span>
<span class="sd">         (Poly(x**2 + 1, x, y, domain=&#39;ZZ&#39;), 2)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;factor_list_include&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">factors</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">factor_list_include</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">DomainError</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;factor_list_include&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">factors</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="Poly.intervals"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.intervals">[docs]</a>    <span class="k">def</span> <span class="nf">intervals</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">inf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sqf</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute isolating intervals for roots of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 3, x).intervals()</span>
<span class="sd">        [((-2, -1), 1), ((1, 2), 1)]</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 3, x).intervals(eps=1e-2)</span>
<span class="sd">        [((-26/15, -19/11), 1), ((19/11, 26/15), 1)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">eps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">eps</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">eps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;&#39;eps&#39; must be a positive rational&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">inf</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sup</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">sup</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;intervals&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">intervals</span><span class="p">(</span>
                <span class="nb">all</span><span class="o">=</span><span class="nb">all</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">inf</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="n">sup</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">,</span> <span class="n">sqf</span><span class="o">=</span><span class="n">sqf</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;intervals&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sqf</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">_real</span><span class="p">(</span><span class="n">interval</span><span class="p">):</span>
                <span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">interval</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_real</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

            <span class="k">def</span> <span class="nf">_complex</span><span class="p">(</span><span class="n">rectangle</span><span class="p">):</span>
                <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">rectangle</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">v</span><span class="p">),</span>
                        <span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

            <span class="n">real_part</span><span class="p">,</span> <span class="n">complex_part</span> <span class="o">=</span> <span class="n">result</span>

            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_real</span><span class="p">,</span> <span class="n">real_part</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_complex</span><span class="p">,</span> <span class="n">complex_part</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">_real</span><span class="p">(</span><span class="n">interval</span><span class="p">):</span>
                <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">k</span> <span class="o">=</span> <span class="n">interval</span>
                <span class="k">return</span> <span class="p">((</span><span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">k</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_real</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>

            <span class="k">def</span> <span class="nf">_complex</span><span class="p">(</span><span class="n">rectangle</span><span class="p">):</span>
                <span class="p">((</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)),</span> <span class="n">k</span> <span class="o">=</span> <span class="n">rectangle</span>
                <span class="k">return</span> <span class="p">((</span><span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">v</span><span class="p">),</span>
                         <span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">k</span><span class="p">)</span>

            <span class="n">real_part</span><span class="p">,</span> <span class="n">complex_part</span> <span class="o">=</span> <span class="n">result</span>

            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_real</span><span class="p">,</span> <span class="n">real_part</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_complex</span><span class="p">,</span> <span class="n">complex_part</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Poly.refine_root"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.refine_root">[docs]</a>    <span class="k">def</span> <span class="nf">refine_root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">check_sqf</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Refine an isolating interval of a root to the given precision.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 3, x).refine_root(1, 2, eps=1e-2)</span>
<span class="sd">        (19/11, 26/15)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">check_sqf</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">is_sqf</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;only square-free polynomials supported&quot;</span><span class="p">)</span>

        <span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">eps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">eps</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">eps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;&#39;eps&#39; must be a positive rational&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">eps</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;refine_root&#39;</span><span class="p">):</span>
            <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">refine_root</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;refine_root&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">QQ</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.count_roots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.count_roots">[docs]</a>    <span class="k">def</span> <span class="nf">count_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">inf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the number of roots of ``f`` in ``[inf, sup]`` interval.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly, I</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**4 - 4, x).count_roots(-3, 3)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**4 - 4, x).count_roots(0, 1 + 3*I)</span>
<span class="sd">        1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inf_real</span><span class="p">,</span> <span class="n">sup_real</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="n">inf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">inf</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">inf</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">:</span>
                <span class="n">inf</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">re</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">im</span><span class="p">:</span>
                    <span class="n">inf</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">inf</span><span class="p">,</span> <span class="n">inf_real</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">,</span> <span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">))),</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">sup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sup</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">sup</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sup</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
                <span class="n">sup</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">re</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">sup</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">im</span><span class="p">:</span>
                    <span class="n">sup</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">sup</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sup</span><span class="p">,</span> <span class="n">sup_real</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">convert</span><span class="p">,</span> <span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">))),</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">inf_real</span> <span class="ow">and</span> <span class="n">sup_real</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;count_real_roots&#39;</span><span class="p">):</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">count_real_roots</span><span class="p">(</span><span class="n">inf</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="n">sup</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
                <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;count_real_roots&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inf_real</span> <span class="ow">and</span> <span class="n">inf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">inf</span> <span class="o">=</span> <span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">QQ</span><span class="o">.</span><span class="n">zero</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sup_real</span> <span class="ow">and</span> <span class="n">sup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">sup</span> <span class="o">=</span> <span class="p">(</span><span class="n">sup</span><span class="p">,</span> <span class="n">QQ</span><span class="o">.</span><span class="n">zero</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="s">&#39;count_complex_roots&#39;</span><span class="p">):</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">count_complex_roots</span><span class="p">(</span><span class="n">inf</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="n">sup</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
                <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;count_complex_roots&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.root"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.root">[docs]</a>    <span class="k">def</span> <span class="nf">root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">radicals</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get an indexed root of a polynomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(2*x**3 - 7*x**2 + 4*x + 4)</span>

<span class="sd">        &gt;&gt;&gt; f.root(0)</span>
<span class="sd">        -1/2</span>
<span class="sd">        &gt;&gt;&gt; f.root(1)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; f.root(2)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; f.root(3)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        IndexError: root index out of [-3, 2] range, got 3</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**5 + x + 1).root(0)</span>
<span class="sd">        RootOf(x**3 - x**2 + 1, 0)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">sympy</span><span class="o">.</span><span class="n">polys</span><span class="o">.</span><span class="n">rootoftools</span><span class="o">.</span><span class="n">RootOf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">radicals</span><span class="o">=</span><span class="n">radicals</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.real_roots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.real_roots">[docs]</a>    <span class="k">def</span> <span class="nf">real_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">radicals</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of real roots with multiplicities.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x**3 - 7*x**2 + 4*x + 4).real_roots()</span>
<span class="sd">        [-1/2, 2, 2]</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**3 + x + 1).real_roots()</span>
<span class="sd">        [RootOf(x**3 + x + 1, 0)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reals</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">polys</span><span class="o">.</span><span class="n">rootoftools</span><span class="o">.</span><span class="n">RootOf</span><span class="o">.</span><span class="n">real_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">radicals</span><span class="o">=</span><span class="n">radicals</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">multiple</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reals</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">group</span><span class="p">(</span><span class="n">reals</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.all_roots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.all_roots">[docs]</a>    <span class="k">def</span> <span class="nf">all_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">radicals</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of real and complex roots with multiplicities.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x**3 - 7*x**2 + 4*x + 4).all_roots()</span>
<span class="sd">        [-1/2, 2, 2]</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**3 + x + 1).all_roots()</span>
<span class="sd">        [RootOf(x**3 + x + 1, 0),</span>
<span class="sd">         RootOf(x**3 + x + 1, 1),</span>
<span class="sd">         RootOf(x**3 + x + 1, 2)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">roots</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">polys</span><span class="o">.</span><span class="n">rootoftools</span><span class="o">.</span><span class="n">RootOf</span><span class="o">.</span><span class="n">all_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">radicals</span><span class="o">=</span><span class="n">radicals</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">multiple</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">roots</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">group</span><span class="p">(</span><span class="n">roots</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.nroots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.nroots">[docs]</a>    <span class="k">def</span> <span class="nf">nroots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">maxsteps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cleanup</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute numerical approximations of roots of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 3).nroots(n=15)</span>
<span class="sd">        [-1.73205080756888, 1.73205080756888]</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 3).nroots(n=30)</span>
<span class="sd">        [-1.73205080756887729352744634151, 1.73205080756887729352744634151]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_multivariate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultivariatePolynomialError</span><span class="p">(</span>
                <span class="s">&quot;can&#39;t compute numerical roots of </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">coeff</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
                   <span class="k">for</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">all_coeffs</span><span class="p">()</span> <span class="p">]</span>

        <span class="n">dps</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">mpmath</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">dps</span>
        <span class="n">sympy</span><span class="o">.</span><span class="n">mpmath</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">dps</span> <span class="o">=</span> <span class="n">n</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sympy</span><span class="o">.</span><span class="n">mpmath</span><span class="o">.</span><span class="n">mpc</span><span class="p">(</span><span class="o">*</span><span class="n">coeff</span><span class="p">)</span> <span class="k">for</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">coeffs</span> <span class="p">]</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DomainError</span><span class="p">(</span>
                    <span class="s">&quot;numerical domain expected, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">)</span>

            <span class="n">result</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">mpmath</span><span class="o">.</span><span class="n">polyroots</span><span class="p">(</span>
                <span class="n">coeffs</span><span class="p">,</span> <span class="n">maxsteps</span><span class="o">=</span><span class="n">maxsteps</span><span class="p">,</span> <span class="n">cleanup</span><span class="o">=</span><span class="n">cleanup</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
                <span class="n">roots</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">result</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">roots</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">result</span><span class="p">,</span> <span class="bp">None</span>

            <span class="n">roots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">roots</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">imag</span><span class="p">))))</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sympy</span><span class="o">.</span><span class="n">mpmath</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">dps</span> <span class="o">=</span> <span class="n">dps</span>

        <span class="k">if</span> <span class="n">error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">roots</span><span class="p">,</span> <span class="n">sympify</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">roots</span>
</div>
<div class="viewcode-block" id="Poly.ground_roots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.ground_roots">[docs]</a>    <span class="k">def</span> <span class="nf">ground_roots</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute roots of ``f`` by factorization in the ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**6 - 4*x**4 + 4*x**3 - x**2).ground_roots()</span>
<span class="sd">        {0: 2, 1: 2}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_multivariate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultivariatePolynomialError</span><span class="p">(</span>
                <span class="s">&quot;can&#39;t compute ground roots of </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

        <span class="n">roots</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">factor</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">factor_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">factor</span><span class="o">.</span><span class="n">is_linear</span><span class="p">:</span>
                <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">factor</span><span class="o">.</span><span class="n">all_coeffs</span><span class="p">()</span>
                <span class="n">roots</span><span class="p">[</span><span class="o">-</span><span class="n">b</span><span class="o">/</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>

        <span class="k">return</span> <span class="n">roots</span>
</div>
<div class="viewcode-block" id="Poly.nth_power_roots_poly"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.nth_power_roots_poly">[docs]</a>    <span class="k">def</span> <span class="nf">nth_power_roots_poly</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a polynomial with n-th powers of roots of ``f``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = Poly(x**4 - x**2 + 1)</span>

<span class="sd">        &gt;&gt;&gt; f.nth_power_roots_poly(2)</span>
<span class="sd">        Poly(x**4 - 2*x**3 + 3*x**2 - 2*x + 1, x, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f.nth_power_roots_poly(3)</span>
<span class="sd">        Poly(x**4 + 2*x**2 + 1, x, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f.nth_power_roots_poly(4)</span>
<span class="sd">        Poly(x**4 + 2*x**3 + 3*x**2 + 2*x + 1, x, domain=&#39;ZZ&#39;)</span>
<span class="sd">        &gt;&gt;&gt; f.nth_power_roots_poly(12)</span>
<span class="sd">        Poly(x**4 - 4*x**3 + 6*x**2 - 4*x + 1, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_multivariate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultivariatePolynomialError</span><span class="p">(</span>
                <span class="s">&quot;must be a univariate polynomial&quot;</span><span class="p">)</span>

        <span class="n">N</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">N</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;&#39;n&#39; must an integer and n &gt;= 1, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gen</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>

        <span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">from_expr</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span> <span class="o">-</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Poly.cancel"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cancel common factors in a rational function ``f/g``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x**2 - 2, x).cancel(Poly(x**2 - 2*x + 1, x))</span>
<span class="sd">        (1, Poly(2*x + 2, x, domain=&#39;ZZ&#39;), Poly(x - 1, x, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x**2 - 2, x).cancel(Poly(x**2 - 2*x + 1, x), include=True)</span>
<span class="sd">        (Poly(2*x + 2, x, domain=&#39;ZZ&#39;), Poly(x - 1, x, domain=&#39;ZZ&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">_unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="s">&#39;cancel&#39;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">OperationNotSupported</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;cancel&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">include</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dom</span><span class="o">.</span><span class="n">has_assoc_Ring</span><span class="p">:</span>
                <span class="n">dom</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">get_ring</span><span class="p">()</span>

            <span class="n">cp</span><span class="p">,</span> <span class="n">cq</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">result</span>

            <span class="n">cp</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
            <span class="n">cq</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">cq</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">cp</span><span class="o">/</span><span class="n">cq</span><span class="p">,</span> <span class="n">per</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">per</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">per</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_zero"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_zero">[docs]</a>    <span class="k">def</span> <span class="nf">is_zero</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is a zero polynomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(0, x).is_zero</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(1, x).is_zero</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_zero</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_one"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_one">[docs]</a>    <span class="k">def</span> <span class="nf">is_one</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is a unit polynomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(0, x).is_one</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Poly(1, x).is_one</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_one</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_sqf"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_sqf">[docs]</a>    <span class="k">def</span> <span class="nf">is_sqf</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is a square-free polynomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 2*x + 1, x).is_sqf</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 - 1, x).is_sqf</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_sqf</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_monic"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_monic">[docs]</a>    <span class="k">def</span> <span class="nf">is_monic</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if the leading coefficient of ``f`` is one.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x + 2, x).is_monic</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(2*x + 2, x).is_monic</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_monic</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_primitive"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_primitive">[docs]</a>    <span class="k">def</span> <span class="nf">is_primitive</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if GCD of the coefficients of ``f`` is one.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(2*x**2 + 6*x + 12, x).is_primitive</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 3*x + 6, x).is_primitive</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_primitive</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_ground"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_ground">[docs]</a>    <span class="k">def</span> <span class="nf">is_ground</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is an element of the ground domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x, x).is_ground</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Poly(2, x).is_ground</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(y, x).is_ground</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_ground</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_linear"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_linear">[docs]</a>    <span class="k">def</span> <span class="nf">is_linear</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is linear in all its variables.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x + y + 2, x, y).is_linear</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(x*y + 2, x, y).is_linear</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_linear</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_quadratic"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_quadratic">[docs]</a>    <span class="k">def</span> <span class="nf">is_quadratic</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is quadratic in all its variables.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x*y + 2, x, y).is_quadratic</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(x*y**2 + 2, x, y).is_quadratic</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_quadratic</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_monomial"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_monomial">[docs]</a>    <span class="k">def</span> <span class="nf">is_monomial</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is zero or has only one term.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(3*x**2, x).is_monomial</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(3*x**2 + 1, x).is_monomial</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_monomial</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_homogeneous"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_homogeneous">[docs]</a>    <span class="k">def</span> <span class="nf">is_homogeneous</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is a homogeneous polynomial.</span>

<span class="sd">        A homogeneous polynomial is a polynomial whose all monomials with</span>
<span class="sd">        non-zero coefficients have the same total degree. If you want not</span>
<span class="sd">        only to check if a polynomial is homogeneous but also compute its</span>
<span class="sd">        homogeneous order, then use :func:`Poly.homogeneous_order`.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + x*y, x, y).is_homogeneous</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**3 + x*y, x, y).is_homogeneous</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_homogeneous</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_irreducible"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_irreducible">[docs]</a>    <span class="k">def</span> <span class="nf">is_irreducible</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` has no factors over its domain.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + x + 1, x, modulus=2).is_irreducible</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + 1, x, modulus=2).is_irreducible</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_irreducible</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_univariate"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_univariate">[docs]</a>    <span class="k">def</span> <span class="nf">is_univariate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is a univariate polynomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + x + 1, x).is_univariate</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(x*y**2 + x*y + 1, x, y).is_univariate</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Poly(x*y**2 + x*y + 1, x).is_univariate</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + x + 1, x, y).is_univariate</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_multivariate"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_multivariate">[docs]</a>    <span class="k">def</span> <span class="nf">is_multivariate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is a multivariate polynomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; Poly(x**2 + x + 1, x).is_multivariate</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Poly(x*y**2 + x*y + 1, x, y).is_multivariate</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Poly(x*y**2 + x*y + 1, x).is_multivariate</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Poly(x**2 + x + 1, x, y).is_multivariate</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Poly.is_cyclotomic"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.Poly.is_cyclotomic">[docs]</a>    <span class="k">def</span> <span class="nf">is_cyclotomic</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``True`` if ``f`` is a cyclotomic polnomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import Poly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">        &gt;&gt;&gt; f = x**16 + x**14 - x**10 + x**8 - x**6 + x**2 + 1</span>

<span class="sd">        &gt;&gt;&gt; Poly(f).is_cyclotomic</span>
<span class="sd">        False</span>

<span class="sd">        &gt;&gt;&gt; g = x**16 + x**14 - x**10 - x**8 - x**6 + x**2 + 1</span>

<span class="sd">        &gt;&gt;&gt; Poly(g).is_cyclotomic</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">is_cyclotomic</span>
</div>
    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">neg</span><span class="p">()</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">PolynomialError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="o">+</span> <span class="n">g</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">PolynomialError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">g</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">PolynomialError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="o">-</span> <span class="n">g</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">PolynomialError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">g</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">PolynomialError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span><span class="o">*</span><span class="n">g</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">PolynomialError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">g</span><span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span><span class="o">**</span><span class="n">n</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__divmod__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__rdivmod__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__mod__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__rmod__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">rem</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">quo</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__rfloordiv__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">quo</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span><span class="o">/</span><span class="n">g</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span><span class="o">/</span><span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>

    <span class="n">__truediv__</span> <span class="o">=</span> <span class="n">__div__</span>
    <span class="n">__rtruediv__</span> <span class="o">=</span> <span class="n">__rdiv__</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">get_domain</span><span class="p">())</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">PolynomialError</span><span class="p">,</span> <span class="n">DomainError</span><span class="p">,</span> <span class="n">CoercionFailed</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span> <span class="o">!=</span> <span class="n">g</span><span class="o">.</span><span class="n">gens</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dom</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">unify</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">UnificationFailed</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>

            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">rep</span>

    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">__eq__</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">is_zero</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">is_zero</span>

    <span class="k">def</span> <span class="nf">eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">strict</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">__eq__</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">_strict_eq</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">ne</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_strict_eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">gens</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="PurePoly"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.PurePoly">[docs]</a><span class="k">class</span> <span class="nc">PurePoly</span><span class="p">(</span><span class="n">Poly</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for representing pure polynomials. &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_hashable_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow SymPy to hash Poly instances. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">PurePoly</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__hash__</span><span class="p">()</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="PurePoly.free_symbols"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.PurePoly.free_symbols">[docs]</a>    <span class="k">def</span> <span class="nf">free_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Free symbols of a polynomial.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import PurePoly</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; PurePoly(x**2 + 1).free_symbols</span>
<span class="sd">        set()</span>
<span class="sd">        &gt;&gt;&gt; PurePoly(x**2 + y).free_symbols</span>
<span class="sd">        set()</span>
<span class="sd">        &gt;&gt;&gt; PurePoly(x**2 + y, x).free_symbols</span>
<span class="sd">        set([y])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols_in_domain</span>
</div>
    <span class="nd">@_sympifyit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="bp">NotImplemented</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">get_domain</span><span class="p">())</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">PolynomialError</span><span class="p">,</span> <span class="n">DomainError</span><span class="p">,</span> <span class="n">CoercionFailed</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gens</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dom</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">unify</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">UnificationFailed</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>

            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">rep</span>

    <span class="k">def</span> <span class="nf">_strict_eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_unify</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">per</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">from_sympy</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
            <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">UnificationFailed</span><span class="p">(</span><span class="s">&quot;can&#39;t unify </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gens</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">UnificationFailed</span><span class="p">(</span><span class="s">&quot;can&#39;t unify </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">DMP</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="p">,</span> <span class="n">DMP</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">UnificationFailed</span><span class="p">(</span><span class="s">&quot;can&#39;t unify </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>

        <span class="n">cls</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span>
        <span class="n">gens</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span>

        <span class="n">dom</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">unify</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="n">gens</span><span class="p">)</span>

        <span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">dom</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">per</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">dom</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span> <span class="n">gens</span><span class="o">=</span><span class="n">gens</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">remove</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">gens</span> <span class="o">=</span> <span class="n">gens</span><span class="p">[:</span><span class="n">remove</span><span class="p">]</span> <span class="o">+</span> <span class="n">gens</span><span class="p">[</span><span class="n">remove</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">dom</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dom</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="poly_from_expr"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.poly_from_expr">[docs]</a><span class="k">def</span> <span class="nf">poly_from_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct a polynomial from an expression. &quot;&quot;&quot;</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_poly_from_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>

</div>
<span class="k">def</span> <span class="nf">_poly_from_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct a polynomial from an expression. &quot;&quot;&quot;</span>
    <span class="n">orig</span><span class="p">,</span> <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="p">,</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Basic</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">PolificationFailed</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">orig</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">_from_poly</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>

        <span class="n">opt</span><span class="o">.</span><span class="n">gens</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">gens</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">domain</span>

        <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">opt</span><span class="o">.</span><span class="n">polys</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">return</span> <span class="n">poly</span><span class="p">,</span> <span class="n">opt</span>
    <span class="k">elif</span> <span class="n">opt</span><span class="o">.</span><span class="n">expand</span><span class="p">:</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">rep</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">_dict_from_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">GeneratorsNeeded</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PolificationFailed</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">orig</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>

    <span class="n">monoms</span><span class="p">,</span> <span class="n">coeffs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">rep</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span>

    <span class="k">if</span> <span class="n">domain</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="n">coeffs</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">from_sympy</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">))</span>

    <span class="n">rep</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">monoms</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">)))</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">polys</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">return</span> <span class="n">poly</span><span class="p">,</span> <span class="n">opt</span>


<span class="nd">@public</span>
<div class="viewcode-block" id="parallel_poly_from_expr"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.parallel_poly_from_expr">[docs]</a><span class="k">def</span> <span class="nf">parallel_poly_from_expr</span><span class="p">(</span><span class="n">exprs</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct polynomials from expressions. &quot;&quot;&quot;</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_parallel_poly_from_expr</span><span class="p">(</span><span class="n">exprs</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>

</div>
<span class="k">def</span> <span class="nf">_parallel_poly_from_expr</span><span class="p">(</span><span class="n">exprs</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct polynomials from expressions. &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">exprs</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Poly</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Poly</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">_from_poly</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">_from_poly</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>

            <span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

            <span class="n">opt</span><span class="o">.</span><span class="n">gens</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span>
            <span class="n">opt</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">domain</span>

            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">opt</span><span class="o">.</span><span class="n">polys</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">],</span> <span class="n">opt</span>

    <span class="n">origs</span><span class="p">,</span> <span class="n">exprs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">exprs</span><span class="p">),</span> <span class="p">[]</span>
    <span class="n">_exprs</span><span class="p">,</span> <span class="n">_polys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="n">failed</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">origs</span><span class="p">):</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Basic</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
                <span class="n">_polys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_exprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">expand</span><span class="p">:</span>
                    <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">failed</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">exprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">failed</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PolificationFailed</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">origs</span><span class="p">,</span> <span class="n">exprs</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_polys</span><span class="p">:</span>
        <span class="c"># XXX: this is a temporary solution</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_polys</span><span class="p">:</span>
            <span class="n">exprs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">exprs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">reps</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">_parallel_dict_from_expr</span><span class="p">(</span><span class="n">exprs</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">GeneratorsNeeded</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PolificationFailed</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">origs</span><span class="p">,</span> <span class="n">exprs</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">opt</span><span class="o">.</span><span class="n">gens</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">Piecewise</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;Piecewise generators do not make sense&quot;</span><span class="p">)</span>

    <span class="n">coeffs_list</span><span class="p">,</span> <span class="n">lengths</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="n">all_monoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_coeffs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">rep</span> <span class="ow">in</span> <span class="n">reps</span><span class="p">:</span>
        <span class="n">monoms</span><span class="p">,</span> <span class="n">coeffs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">rep</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>

        <span class="n">coeffs_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
        <span class="n">all_monoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">monoms</span><span class="p">)</span>

        <span class="n">lengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">))</span>

    <span class="n">domain</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span>

    <span class="k">if</span> <span class="n">domain</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="n">coeffs_list</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">coeffs_list</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coeffs_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">from_sympy</span><span class="p">,</span> <span class="n">coeffs_list</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">lengths</span><span class="p">:</span>
        <span class="n">all_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeffs_list</span><span class="p">[:</span><span class="n">k</span><span class="p">])</span>
        <span class="n">coeffs_list</span> <span class="o">=</span> <span class="n">coeffs_list</span><span class="p">[</span><span class="n">k</span><span class="p">:]</span>

    <span class="n">polys</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">monoms</span><span class="p">,</span> <span class="n">coeffs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_monoms</span><span class="p">,</span> <span class="n">all_coeffs</span><span class="p">):</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">monoms</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">)))</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
        <span class="n">polys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">polys</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">_polys</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">polys</span><span class="p">,</span> <span class="n">opt</span>


<span class="k">def</span> <span class="nf">_update_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a new ``(key, value)`` pair to arguments ``dict``. &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">args</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">args</span>


<span class="nd">@public</span>
<div class="viewcode-block" id="degree"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.degree">[docs]</a><span class="k">def</span> <span class="nf">degree</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the degree of ``f`` in the given variable.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import degree</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; degree(x**2 + y*x + 1, gen=x)</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; degree(x**2 + y*x + 1, gen=y)</span>
<span class="sd">    1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;gen&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;degree&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">gen</span><span class="p">))</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="degree_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.degree_list">[docs]</a><span class="k">def</span> <span class="nf">degree_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a list of degrees of ``f`` in all variables.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import degree_list</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; degree_list(x**2 + y*x + 1)</span>
<span class="sd">    (2, 1)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;degree_list&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">degrees</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">degree_list</span><span class="p">()</span>

    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">degrees</span><span class="p">))</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="LC"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.LC">[docs]</a><span class="k">def</span> <span class="nf">LC</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the leading coefficient of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import LC</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; LC(4*x**2 + 2*x*y**2 + x*y + 3*y)</span>
<span class="sd">    4</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;LC&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">LC</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="LM"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.LM">[docs]</a><span class="k">def</span> <span class="nf">LM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the leading monomial of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import LM</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; LM(4*x**2 + 2*x*y**2 + x*y + 3*y)</span>
<span class="sd">    x**2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;LM&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">monom</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">LM</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">monom</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="LT"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.LT">[docs]</a><span class="k">def</span> <span class="nf">LT</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the leading term of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import LT</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; LT(4*x**2 + 2*x*y**2 + x*y + 3*y)</span>
<span class="sd">    4*x**2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;LT&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">monom</span><span class="p">,</span> <span class="n">coeff</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">LT</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coeff</span><span class="o">*</span><span class="n">monom</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="pdiv"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.pdiv">[docs]</a><span class="k">def</span> <span class="nf">pdiv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute polynomial pseudo-division of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import pdiv</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; pdiv(x**2 + 1, 2*x - 4)</span>
<span class="sd">    (2*x + 4, 20)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;pdiv&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pdiv</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="prem"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.prem">[docs]</a><span class="k">def</span> <span class="nf">prem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute polynomial pseudo-remainder of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import prem</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; prem(x**2 + 1, 2*x - 4)</span>
<span class="sd">    20</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;prem&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">prem</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="pquo"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.pquo">[docs]</a><span class="k">def</span> <span class="nf">pquo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute polynomial pseudo-quotient of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import pquo</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; pquo(x**2 + 1, 2*x - 4)</span>
<span class="sd">    2*x + 4</span>
<span class="sd">    &gt;&gt;&gt; pquo(x**2 - 1, 2*x - 1)</span>
<span class="sd">    2*x + 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;pquo&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pquo</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ExactQuotientFailed</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ExactQuotientFailed</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="pexquo"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.pexquo">[docs]</a><span class="k">def</span> <span class="nf">pexquo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute polynomial exact pseudo-quotient of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import pexquo</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; pexquo(x**2 - 1, 2*x - 2)</span>
<span class="sd">    2*x + 2</span>

<span class="sd">    &gt;&gt;&gt; pexquo(x**2 + 1, 2*x - 4)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ExactQuotientFailed: 2*x - 4 does not divide x**2 + 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;pexquo&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pexquo</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="div"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.div">[docs]</a><span class="k">def</span> <span class="nf">div</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute polynomial division of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import div, ZZ, QQ</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; div(x**2 + 1, 2*x - 4, domain=ZZ)</span>
<span class="sd">    (0, x**2 + 1)</span>
<span class="sd">    &gt;&gt;&gt; div(x**2 + 1, 2*x - 4, domain=QQ)</span>
<span class="sd">    (x/2 + 1, 5)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="rem"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.rem">[docs]</a><span class="k">def</span> <span class="nf">rem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute polynomial remainder of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import rem, ZZ, QQ</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; rem(x**2 + 1, 2*x - 4, domain=ZZ)</span>
<span class="sd">    x**2 + 1</span>
<span class="sd">    &gt;&gt;&gt; rem(x**2 + 1, 2*x - 4, domain=QQ)</span>
<span class="sd">    5</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;rem&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">rem</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="quo"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.quo">[docs]</a><span class="k">def</span> <span class="nf">quo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute polynomial quotient of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import quo</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; quo(x**2 + 1, 2*x - 4)</span>
<span class="sd">    x/2 + 1</span>
<span class="sd">    &gt;&gt;&gt; quo(x**2 - 1, x - 1)</span>
<span class="sd">    x + 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;quo&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">quo</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="exquo"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.exquo">[docs]</a><span class="k">def</span> <span class="nf">exquo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute polynomial exact quotient of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import exquo</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; exquo(x**2 - 1, x - 1)</span>
<span class="sd">    x + 1</span>

<span class="sd">    &gt;&gt;&gt; exquo(x**2 + 1, 2*x - 4)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ExactQuotientFailed: 2*x - 4 does not divide x**2 + 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;exquo&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">exquo</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">q</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="half_gcdex"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.half_gcdex">[docs]</a><span class="k">def</span> <span class="nf">half_gcdex</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Half extended Euclidean algorithm of ``f`` and ``g``.</span>

<span class="sd">    Returns ``(s, h)`` such that ``h = gcd(f, g)`` and ``s*f = h (mod g)``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import half_gcdex</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; half_gcdex(x**4 - 2*x**3 - 6*x**2 + 12*x + 15, x**3 + x**2 - 4*x - 4)</span>
<span class="sd">    (-x/5 + 3/5, x + 1)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">exprs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">half_gcdex</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;half_gcdex&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

    <span class="n">s</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">half_gcdex</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">h</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">h</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="gcdex"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.gcdex">[docs]</a><span class="k">def</span> <span class="nf">gcdex</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extended Euclidean algorithm of ``f`` and ``g``.</span>

<span class="sd">    Returns ``(s, t, h)`` such that ``h = gcd(f, g)`` and ``s*f + t*g = h``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import gcdex</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; gcdex(x**4 - 2*x**3 - 6*x**2 + 12*x + 15, x**3 + x**2 - 4*x - 4)</span>
<span class="sd">    (-x/5 + 3/5, x**2/5 - 6*x/5 + 2, x + 1)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">exprs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">gcdex</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;gcdex&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

    <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gcdex</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">h</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="invert"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.invert">[docs]</a><span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Invert ``f`` modulo ``g`` when possible.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import invert</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; invert(x**2 - 1, 2*x - 1)</span>
<span class="sd">    -4/3</span>

<span class="sd">    &gt;&gt;&gt; invert(x**2 - 1, x - 1)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    NotInvertible: zero divisor</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">exprs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;invert&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">h</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">h</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="subresultants"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.subresultants">[docs]</a><span class="k">def</span> <span class="nf">subresultants</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute subresultant PRS of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import subresultants</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; subresultants(x**2 + 1, x**2 - 1)</span>
<span class="sd">    [x**2 + 1, x**2 - 1, -2]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;subresultants&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">subresultants</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span> <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="resultant"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.resultant">[docs]</a><span class="k">def</span> <span class="nf">resultant</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute resultant of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import resultant</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; resultant(x**2 + 1, x**2 - 1)</span>
<span class="sd">    4</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">includePRS</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;includePRS&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;resultant&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">includePRS</span><span class="p">:</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">includePRS</span><span class="o">=</span><span class="n">includePRS</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">includePRS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">includePRS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">R</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="discriminant"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.discriminant">[docs]</a><span class="k">def</span> <span class="nf">discriminant</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute discriminant of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import discriminant</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; discriminant(x**2 + 2*x + 3)</span>
<span class="sd">    -8</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;discriminant&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="cofactors"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.cofactors">[docs]</a><span class="k">def</span> <span class="nf">cofactors</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute GCD and cofactors of ``f`` and ``g``.</span>

<span class="sd">    Returns polynomials ``(h, cff, cfg)`` such that ``h = gcd(f, g)``, and</span>
<span class="sd">    ``cff = quo(f, h)`` and ``cfg = quo(g, h)`` are, so called, cofactors</span>
<span class="sd">    of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import cofactors</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; cofactors(x**2 - 1, x**2 - 3*x + 2)</span>
<span class="sd">    (x - 1, x + 1, x - 2)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">exprs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">cff</span><span class="p">,</span> <span class="n">cfg</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">cofactors</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;cofactors&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">cff</span><span class="p">),</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>

    <span class="n">h</span><span class="p">,</span> <span class="n">cff</span><span class="p">,</span> <span class="n">cfg</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cofactors</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">h</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">cff</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">cfg</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">cff</span><span class="p">,</span> <span class="n">cfg</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="gcd_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.gcd_list">[docs]</a><span class="k">def</span> <span class="nf">gcd_list</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute GCD of a list of polynomials.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import gcd_list</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; gcd_list([x**3 - 1, x**2 - 1, x**2 - 3*x + 2])</span>
<span class="sd">    x - 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">domain</span><span class="p">,</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">numbers</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">zero</span>
        <span class="k">elif</span> <span class="n">domain</span><span class="o">.</span><span class="n">is_Numerical</span><span class="p">:</span>
            <span class="n">result</span><span class="p">,</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

            <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">domain</span><span class="o">.</span><span class="n">is_one</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                    <span class="k">break</span>

            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">polys</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;gcd_list&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">),</span> <span class="n">exc</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">polys</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>

    <span class="n">result</span><span class="p">,</span> <span class="n">polys</span> <span class="o">=</span> <span class="n">polys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polys</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">polys</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_one</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="gcd"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.gcd">[docs]</a><span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute GCD of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import gcd</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; gcd(x**2 - 1, x**2 - 3*x + 2)</span>
<span class="sd">    x - 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">g</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="p">,)</span> <span class="o">+</span> <span class="n">gens</span>

        <span class="k">return</span> <span class="n">gcd_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">g</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;gcd() takes 2 arguments or a sequence of arguments&quot;</span><span class="p">)</span>

    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">exprs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;gcd&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="lcm_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.lcm_list">[docs]</a><span class="k">def</span> <span class="nf">lcm_list</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute LCM of a list of polynomials.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import lcm_list</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; lcm_list([x**3 - 1, x**2 - 1, x**2 - 3*x + 2])</span>
<span class="sd">    x**5 - x**4 - 2*x**3 - x**2 + x + 2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">gens</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">domain</span><span class="p">,</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">numbers</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">one</span>
        <span class="k">elif</span> <span class="n">domain</span><span class="o">.</span><span class="n">is_Numerical</span><span class="p">:</span>
            <span class="n">result</span><span class="p">,</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

            <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">polys</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;lcm_list&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">),</span> <span class="n">exc</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">polys</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>

    <span class="n">result</span><span class="p">,</span> <span class="n">polys</span> <span class="o">=</span> <span class="n">polys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polys</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">polys</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="lcm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.lcm">[docs]</a><span class="k">def</span> <span class="nf">lcm</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute LCM of ``f`` and ``g``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import lcm</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; lcm(x**2 - 1, x**2 - 3*x + 2)</span>
<span class="sd">    x**3 - 2*x**2 - x + 2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">g</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">gens</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="p">,)</span> <span class="o">+</span> <span class="n">gens</span>

        <span class="k">return</span> <span class="n">lcm_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">g</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;lcm() takes 2 arguments or a sequence of arguments&quot;</span><span class="p">)</span>

    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">construct_domain</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">exprs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;lcm&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="terms_gcd"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.terms_gcd">[docs]</a><span class="k">def</span> <span class="nf">terms_gcd</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove GCD of terms from ``f``.</span>

<span class="sd">    If the ``deep`` flag is True, then the arguments of ``f`` will have</span>
<span class="sd">    terms_gcd applied to them.</span>

<span class="sd">    If a fraction is factored out of ``f`` and ``f`` is an Add, then</span>
<span class="sd">    an unevaluated Mul will be returned so that automatic simplification</span>
<span class="sd">    does not redistribute it. The hint ``clear``, when set to False, can be</span>
<span class="sd">    used to prevent such factoring when all coefficients are not fractions.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import terms_gcd, cos, pi</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>
<span class="sd">    &gt;&gt;&gt; terms_gcd(x**6*y**2 + x**3*y, x, y)</span>
<span class="sd">    x**3*y*(x**3*y + 1)</span>

<span class="sd">    The default action of polys routines is to expand the expression</span>
<span class="sd">    given to them. terms_gcd follows this behavior:</span>

<span class="sd">    &gt;&gt;&gt; terms_gcd((3+3*x)*(x+x*y))</span>
<span class="sd">    3*x*(x*y + x + y + 1)</span>

<span class="sd">    If this is not desired then the hint ``expand`` can be set to False.</span>
<span class="sd">    In this case the expression will be treated as though it were comprised</span>
<span class="sd">    of one or more terms:</span>

<span class="sd">    &gt;&gt;&gt; terms_gcd((3+3*x)*(x+x*y), expand=False)</span>
<span class="sd">    (3*x + 3)*(x*y + x)</span>

<span class="sd">    In order to traverse factors of a Mul or the arguments of other</span>
<span class="sd">    functions, the ``deep`` hint can be used:</span>

<span class="sd">    &gt;&gt;&gt; terms_gcd((3 + 3*x)*(x + x*y), expand=False, deep=True)</span>
<span class="sd">    3*x*(x + 1)*(y + 1)</span>
<span class="sd">    &gt;&gt;&gt; terms_gcd(cos(x + x*y), deep=True)</span>
<span class="sd">    cos(x*(y + 1))</span>

<span class="sd">    Rationals are factored out by default:</span>

<span class="sd">    &gt;&gt;&gt; terms_gcd(x + y/2)</span>
<span class="sd">    (2*x + y)/2</span>

<span class="sd">    Only the y-term had a coefficient that was a fraction; if one</span>
<span class="sd">    does not want to factor out the 1/2 in cases like this, the</span>
<span class="sd">    flag ``clear`` can be set to False:</span>

<span class="sd">    &gt;&gt;&gt; terms_gcd(x + y/2, clear=False)</span>
<span class="sd">    x + y/2</span>
<span class="sd">    &gt;&gt;&gt; terms_gcd(x*y/2 + y**2, clear=False)</span>
<span class="sd">    y*(x/2 + y)</span>

<span class="sd">    The ``clear`` flag is ignored if all coefficients are fractions:</span>

<span class="sd">    &gt;&gt;&gt; terms_gcd(x/3 + y/2, clear=False)</span>
<span class="sd">    (2*x + 3*y)/6</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    sympy.core.exprtools.gcd_terms, sympy.core.exprtools.factor_terms</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">is_Atom</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sympify</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;deep&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">terms_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="p">])</span>
        <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;deep&#39;</span><span class="p">)</span>
        <span class="n">args</span><span class="p">[</span><span class="s">&#39;expand&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">terms_gcd</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

    <span class="n">clear</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;clear&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">exc</span><span class="o">.</span><span class="n">expr</span>

    <span class="n">J</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">terms_gcd</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">has_Ring</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="n">denom</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">clear_denoms</span><span class="p">(</span><span class="n">convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">coeff</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="n">coeff</span> <span class="o">/=</span> <span class="n">denom</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coeff</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>

    <span class="n">term</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">x</span><span class="o">**</span><span class="n">j</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="p">])</span>

    <span class="k">if</span> <span class="n">clear</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_keep_coeff</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">term</span><span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
    <span class="c"># base the clearing on the form of the original expression, not</span>
    <span class="c"># the (perhaps) Mul that we have now</span>
    <span class="n">coeff</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">_keep_coeff</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">clear</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">_keep_coeff</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">term</span><span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="trunc"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.trunc">[docs]</a><span class="k">def</span> <span class="nf">trunc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reduce ``f`` modulo a constant ``p``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import trunc</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; trunc(2*x**3 + 3*x**2 + 5*x + 7, 3)</span>
<span class="sd">    -x**3 - x + 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;trunc&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="monic"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.monic">[docs]</a><span class="k">def</span> <span class="nf">monic</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Divide all coefficients of ``f`` by ``LC(f)``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import monic</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; monic(3*x**2 + 4*x + 2)</span>
<span class="sd">    x**2 + 4*x/3 + 2/3</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;monic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">monic</span><span class="p">(</span><span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="content"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.content">[docs]</a><span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute GCD of coefficients of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import content</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; content(6*x**2 + 8*x + 12)</span>
<span class="sd">    2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;content&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="primitive"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.primitive">[docs]</a><span class="k">def</span> <span class="nf">primitive</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute content and the primitive form of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.polys.polytools import primitive</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; primitive(6*x**2 + 8*x + 12)</span>
<span class="sd">    (2, 3*x**2 + 4*x + 6)</span>

<span class="sd">    &gt;&gt;&gt; eq = (2 + 2*x)*x + 2</span>

<span class="sd">    Expansion is performed by default:</span>

<span class="sd">    &gt;&gt;&gt; primitive(eq)</span>
<span class="sd">    (2, x**2 + x + 1)</span>

<span class="sd">    Set ``expand`` to False to shut this off. Note that the</span>
<span class="sd">    extraction will not be recursive; use the as_content_primitive method</span>
<span class="sd">    for recursive, non-destructive Rational extraction.</span>

<span class="sd">    &gt;&gt;&gt; primitive(eq, expand=False)</span>
<span class="sd">    (1, x*(2*x + 2) + 2)</span>

<span class="sd">    &gt;&gt;&gt; eq.as_content_primitive()</span>
<span class="sd">    (2, x*(x + 1) + 1)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;primitive&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">cont</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cont</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cont</span><span class="p">,</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="compose"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.compose">[docs]</a><span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute functional composition ``f(g)``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import compose</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; compose(x**2 + x, x - 1)</span>
<span class="sd">    x**2 - x</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;compose&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="decompose"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.decompose">[docs]</a><span class="k">def</span> <span class="nf">decompose</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute functional decomposition of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import decompose</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; decompose(x**4 + 2*x**3 - x - 1)</span>
<span class="sd">    [x**2 - x - 1, x**2 + x]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;decompose&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span> <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="sturm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.sturm">[docs]</a><span class="k">def</span> <span class="nf">sturm</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute Sturm sequence of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import sturm</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; sturm(x**3 - 2*x**2 + x - 3)</span>
<span class="sd">    [x**3 - 2*x**2 + x - 3, 3*x**2 - 4*x + 1, 2*x/9 + 25/9, -2079/4]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;auto&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;sturm&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sturm</span><span class="p">(</span><span class="n">auto</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">auto</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span> <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="gff_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.gff_list">[docs]</a><span class="k">def</span> <span class="nf">gff_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute a list of greatest factorial factors of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import gff_list, ff</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; f = x**5 + 2*x**4 - x**3 - 2*x**2</span>

<span class="sd">    &gt;&gt;&gt; gff_list(f)</span>
<span class="sd">    [(x, 1), (x + 2, 4)]</span>

<span class="sd">    &gt;&gt;&gt; (ff(x, 1)*ff(x + 2, 4)).expand() == f</span>
<span class="sd">    True</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;gff_list&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">factors</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gff_list</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">factors</span> <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">factors</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="gff"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.gff">[docs]</a><span class="k">def</span> <span class="nf">gff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute greatest factorial factorization of ``f``. &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;symbolic falling factorial&#39;</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="sqf_norm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.sqf_norm">[docs]</a><span class="k">def</span> <span class="nf">sqf_norm</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute square-free norm of ``f``.</span>

<span class="sd">    Returns ``s``, ``f``, ``r``, such that ``g(x) = f(x-sa)`` and</span>
<span class="sd">    ``r(x) = Norm(g(x))`` is a square-free polynomial over ``K``,</span>
<span class="sd">    where ``a`` is the algebraic extension of the ground domain.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import sqf_norm, sqrt</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; sqf_norm(x**2 + 1, extension=[sqrt(3)])</span>
<span class="sd">    (1, x**2 - 2*sqrt(3)*x + 4, x**4 - 4*x**2 + 16)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;sqf_norm&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">s</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sqf_norm</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">g</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="sqf_part"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.sqf_part">[docs]</a><span class="k">def</span> <span class="nf">sqf_part</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute square-free part of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import sqf_part</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; sqf_part(x**3 - 3*x - 2)</span>
<span class="sd">    x**2 - x - 2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;sqf_part&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sqf_part</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="k">def</span> <span class="nf">_sorted_factors</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sort a list of ``(expr, exp)`` pairs. &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&#39;sqf&#39;</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">key</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">poly</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">rep</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rep</span><span class="p">),</span> <span class="n">rep</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">key</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">poly</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">rep</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rep</span><span class="p">),</span> <span class="n">exp</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_factors_product</span><span class="p">(</span><span class="n">factors</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multiply a list of ``(expr, exp)`` pairs. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span><span class="o">**</span><span class="n">k</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">factors</span> <span class="p">])</span>


<span class="k">def</span> <span class="nf">_symbolic_factor_list</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function for :func:`_symbolic_factor`. &quot;&quot;&quot;</span>
    <span class="n">coeff</span><span class="p">,</span> <span class="n">factors</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
            <span class="n">coeff</span> <span class="o">*=</span> <span class="n">arg</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">arg</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
            <span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">args</span>
            <span class="k">if</span> <span class="n">base</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
                <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">base</span><span class="p">,</span> <span class="n">exp</span><span class="p">))</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">arg</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">poly</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_poly_from_expr</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">exc</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">exp</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">method</span> <span class="o">+</span> <span class="s">&#39;_list&#39;</span><span class="p">)</span>

            <span class="n">_coeff</span><span class="p">,</span> <span class="n">_factors</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">_coeff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
                    <span class="n">coeff</span> <span class="o">*=</span> <span class="n">_coeff</span><span class="o">**</span><span class="n">exp</span>
                <span class="k">elif</span> <span class="n">_coeff</span><span class="o">.</span><span class="n">is_positive</span><span class="p">:</span>
                    <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">_coeff</span><span class="p">,</span> <span class="n">exp</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_factors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">_coeff</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">exp</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
                <span class="n">factors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_factors</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">is_integer</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">_factors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">factors</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">exp</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">_factors</span> <span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">_factors</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span><span class="o">.</span><span class="n">is_positive</span><span class="p">:</span>
                        <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">exp</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="n">other</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">other</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">))</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">f</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">exp</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">_factors_product</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="n">exp</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">factors</span>


<span class="k">def</span> <span class="nf">_symbolic_factor</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function for :func:`_factor`. &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Relational</span><span class="p">:</span>
        <span class="n">coeff</span><span class="p">,</span> <span class="n">factors</span> <span class="o">=</span> <span class="n">_symbolic_factor_list</span><span class="p">(</span><span class="n">together</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="n">opt</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_keep_coeff</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">_factors_product</span><span class="p">(</span><span class="n">factors</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="s">&#39;args&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="p">[</span> <span class="n">_symbolic_factor</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span> <span class="p">])</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">__class__</span><span class="p">([</span> <span class="n">_symbolic_factor</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span> <span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">expr</span>


<span class="k">def</span> <span class="nf">_generic_factor_list</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function for :func:`sqf_list` and :func:`factor_list`. &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;frac&#39;</span><span class="p">,</span> <span class="s">&#39;polys&#39;</span><span class="p">])</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="n">expr</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Relational</span><span class="p">:</span>
        <span class="n">numer</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">together</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">()</span>

        <span class="n">cp</span><span class="p">,</span> <span class="n">fp</span> <span class="o">=</span> <span class="n">_symbolic_factor_list</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
        <span class="n">cq</span><span class="p">,</span> <span class="n">fq</span> <span class="o">=</span> <span class="n">_symbolic_factor_list</span><span class="p">(</span><span class="n">denom</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fq</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">frac</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;a polynomial expected, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">expr</span><span class="p">)</span>

        <span class="n">_opt</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">factors</span> <span class="ow">in</span> <span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fq</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">factors</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
                    <span class="n">f</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">_opt</span><span class="p">)</span>
                    <span class="n">factors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

        <span class="n">fp</span> <span class="o">=</span> <span class="n">_sorted_factors</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
        <span class="n">fq</span> <span class="o">=</span> <span class="n">_sorted_factors</span><span class="p">(</span><span class="n">fq</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fp</span> <span class="p">]</span>
            <span class="n">fq</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fq</span> <span class="p">]</span>

        <span class="n">coeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">/</span><span class="n">cq</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">frac</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">fp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fq</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;a polynomial expected, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">expr</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_generic_factor</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function for :func:`sqf` and :func:`factor`. &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_symbolic_factor</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="n">opt</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">to_rational_coeffs</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    try to transform a polynomial to have rational coefficients</span>

<span class="sd">    try to find a transformation ``x = alpha*y``</span>

<span class="sd">    ``f(x) = lc*alpha**n * g(y)`` where ``g`` is a polynomial with</span>
<span class="sd">    rational coefficients, ``lc`` the leading coefficient.</span>

<span class="sd">    If this fails, try ``x = y + beta``</span>
<span class="sd">    ``f(x) = g(y)``</span>

<span class="sd">    Returns ``None`` if ``g`` not found;</span>
<span class="sd">    ``(lc, alpha, None, g)`` in case of rescaling</span>
<span class="sd">    ``(None, None, beta, g)`` in case of translation</span>

<span class="sd">    Notes</span>
<span class="sd">    =====</span>

<span class="sd">    Currently it transforms only polynomials without roots larger than 2.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import sqrt, Poly, simplify, expand</span>
<span class="sd">    &gt;&gt;&gt; from sympy.polys.polytools import to_rational_coeffs</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>
<span class="sd">    &gt;&gt;&gt; p = Poly(((x**2-1)*(x-2)).subs({x:x*(1 + sqrt(2))}), x, domain=&#39;EX&#39;)</span>
<span class="sd">    &gt;&gt;&gt; lc, r, _, g = to_rational_coeffs(p)</span>
<span class="sd">    &gt;&gt;&gt; lc, r</span>
<span class="sd">    (7 + 5*sqrt(2), -2*sqrt(2) + 2)</span>
<span class="sd">    &gt;&gt;&gt; g</span>
<span class="sd">    Poly(x**3 + x**2 - 1/4*x - 1/4, x, domain=&#39;QQ&#39;)</span>
<span class="sd">    &gt;&gt;&gt; r1 = simplify(1/r)</span>
<span class="sd">    &gt;&gt;&gt; Poly(lc*r**3*(g.as_expr()).subs({x:x*r1}), x, domain=&#39;EX&#39;) == p</span>
<span class="sd">    True</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sympy.simplify.simplify</span> <span class="kn">import</span> <span class="n">simplify</span>

    <span class="k">def</span> <span class="nf">_try_rescale</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        try rescaling ``x -&gt; alpha*x`` to convert f to a polynomial</span>
<span class="sd">        with rational coefficients.</span>
<span class="sd">        Returns ``alpha, f``; if the rescaling is successful,</span>
<span class="sd">        ``alpha`` is the rescaling factor, and ``f`` is the rescaled</span>
<span class="sd">        polynomial; else ``alpha`` is ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sympy.core.add</span> <span class="kn">import</span> <span class="n">Add</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">is_Atom</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="n">f</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">LC</span><span class="p">()</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span><span class="o">.</span><span class="n">all_coeffs</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">simplify</span><span class="p">(</span><span class="n">coeffx</span><span class="p">)</span> <span class="k">for</span> <span class="n">coeffx</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">coeffx</span><span class="o">.</span><span class="n">is_rational</span> <span class="k">for</span> <span class="n">coeffx</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">):</span>
            <span class="n">rescale1_x</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">coeffs1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)):</span>
                <span class="n">coeffx</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">rescale1_x</span><span class="o">**</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">coeffx</span><span class="o">.</span><span class="n">is_rational</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">coeffs1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeffx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rescale_x</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">rescale1_x</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeffs1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span><span class="p">))</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">lc</span><span class="p">,</span> <span class="n">rescale_x</span><span class="p">,</span> <span class="n">f</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">_try_translate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        try translating ``x -&gt; x + alpha`` to convert f to a polynomial</span>
<span class="sd">        with rational coefficients.</span>
<span class="sd">        Returns ``alpha, f``; if the translating is successful,</span>
<span class="sd">        ``alpha`` is the translating factor, and ``f`` is the shifted</span>
<span class="sd">        polynomial; else ``alpha`` is ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sympy.core.add</span> <span class="kn">import</span> <span class="n">Add</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">is_Atom</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="n">f</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">all_coeffs</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">is_rational</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">Add</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">args</span>
                <span class="n">func</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">func</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="n">sifted</span> <span class="o">=</span> <span class="n">sift</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="o">.</span><span class="n">is_rational</span><span class="p">)</span>
            <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">sifted</span><span class="p">[</span><span class="bp">True</span><span class="p">],</span> <span class="n">sifted</span><span class="p">[</span><span class="bp">False</span><span class="p">]</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">c2</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
            <span class="n">f2</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">f2</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">_has_square_roots</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if ``f`` is a sum with square roots but no other root</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sympy.core.exprtools</span> <span class="kn">import</span> <span class="n">Factors</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
        <span class="n">has_sq</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">Factors</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">factors</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">q</span> <span class="k">for</span> <span class="n">wx</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">wx</span><span class="o">.</span><span class="n">is_Rational</span> <span class="ow">and</span> <span class="n">wx</span><span class="o">.</span><span class="n">q</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">has_sq</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">has_sq</span>

    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span><span class="o">.</span><span class="n">is_EX</span> <span class="ow">and</span> <span class="n">_has_square_roots</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="n">rescale_x</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">translate_x</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">_try_rescale</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">_try_translate</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">_torational_factor_list</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    helper function to factor polynomial using to_rational_coeffs</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.polys.polytools import _torational_factor_list</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>
<span class="sd">    &gt;&gt;&gt; from sympy import sqrt, expand, Mul</span>
<span class="sd">    &gt;&gt;&gt; p = expand(((x**2-1)*(x-2)).subs({x:x*(1 + sqrt(2))}))</span>
<span class="sd">    &gt;&gt;&gt; factors = _torational_factor_list(p, x); factors</span>
<span class="sd">    (-2, [(-x*(1 + sqrt(2))/2 + 1, 1), (-x*(1 + sqrt(2)) - 1, 1), (-x*(1 + sqrt(2)) + 1, 1)])</span>
<span class="sd">    &gt;&gt;&gt; expand(factors[0]*Mul(*[z[0] for z in factors[1]])) == p</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; p = expand(((x**2-1)*(x-2)).subs({x:x + sqrt(2)}))</span>
<span class="sd">    &gt;&gt;&gt; factors = _torational_factor_list(p, x); factors</span>
<span class="sd">    (1, [(x - 2 + sqrt(2), 1), (x - 1 + sqrt(2), 1), (x + 1 + sqrt(2), 1)])</span>
<span class="sd">    &gt;&gt;&gt; expand(factors[0]*Mul(*[z[0] for z in factors[1]])) == p</span>
<span class="sd">    True</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sympy.simplify.simplify</span> <span class="kn">import</span> <span class="n">simplify</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">&#39;EX&#39;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">to_rational_coeffs</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">lc</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">res</span>
    <span class="n">factors</span> <span class="o">=</span> <span class="n">factor_list</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">lc</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">factors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">lc</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">r</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">[</span><span class="mi">1</span><span class="p">:][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">simplify</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">r1</span><span class="p">})),</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">factors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">[</span><span class="mi">1</span><span class="p">:][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="n">x</span> <span class="o">-</span> <span class="n">t</span><span class="p">}),</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>


<span class="nd">@public</span>
<div class="viewcode-block" id="sqf_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.sqf_list">[docs]</a><span class="k">def</span> <span class="nf">sqf_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute a list of square-free factors of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import sqf_list</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; sqf_list(2*x**5 + 16*x**4 + 50*x**3 + 76*x**2 + 56*x + 16)</span>
<span class="sd">    (2, [(x + 1, 2), (x + 2, 3)])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_generic_factor_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;sqf&#39;</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="sqf"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.sqf">[docs]</a><span class="k">def</span> <span class="nf">sqf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute square-free factorization of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import sqf</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; sqf(2*x**5 + 16*x**4 + 50*x**3 + 76*x**2 + 56*x + 16)</span>
<span class="sd">    2*(x + 1)**2*(x + 2)**3</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_generic_factor</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;sqf&#39;</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="factor_list"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.factor_list">[docs]</a><span class="k">def</span> <span class="nf">factor_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute a list of irreducible factors of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import factor_list</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; factor_list(2*x**5 + 2*x**4*y + 4*x**3 + 4*x**2*y + 2*x + 2*y)</span>
<span class="sd">    (2, [(x + y, 1), (x**2 + 1, 2)])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_generic_factor_list</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;factor&#39;</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="factor"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.factor">[docs]</a><span class="k">def</span> <span class="nf">factor</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the factorization of expression, ``f``, into irreducibles. (To</span>
<span class="sd">    factor an integer into primes, use ``factorint``.)</span>

<span class="sd">    There two modes implemented: symbolic and formal. If ``f`` is not an</span>
<span class="sd">    instance of :class:`Poly` and generators are not specified, then the</span>
<span class="sd">    former mode is used. Otherwise, the formal mode is used.</span>

<span class="sd">    In symbolic mode, :func:`factor` will traverse the expression tree and</span>
<span class="sd">    factor its components without any prior expansion, unless an instance</span>
<span class="sd">    of :class:`Add` is encountered (in this case formal factorization is</span>
<span class="sd">    used). This way :func:`factor` can handle large or symbolic exponents.</span>

<span class="sd">    By default, the factorization is computed over the rationals. To factor</span>
<span class="sd">    over other domain, e.g. an algebraic or finite field, use appropriate</span>
<span class="sd">    options: ``extension``, ``modulus`` or ``domain``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import factor, sqrt</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; factor(2*x**5 + 2*x**4*y + 4*x**3 + 4*x**2*y + 2*x + 2*y)</span>
<span class="sd">    2*(x + y)*(x**2 + 1)**2</span>

<span class="sd">    &gt;&gt;&gt; factor(x**2 + 1)</span>
<span class="sd">    x**2 + 1</span>
<span class="sd">    &gt;&gt;&gt; factor(x**2 + 1, modulus=2)</span>
<span class="sd">    (x + 1)**2</span>
<span class="sd">    &gt;&gt;&gt; factor(x**2 + 1, gaussian=True)</span>
<span class="sd">    (x - I)*(x + I)</span>

<span class="sd">    &gt;&gt;&gt; factor(x**2 - 2, extension=sqrt(2))</span>
<span class="sd">    (x - sqrt(2))*(x + sqrt(2))</span>

<span class="sd">    &gt;&gt;&gt; factor((x**2 - 1)/(x**2 + 4*x + 4))</span>
<span class="sd">    (x - 1)*(x + 1)/(x + 2)**2</span>
<span class="sd">    &gt;&gt;&gt; factor((x**2 + 4*x + 4)**10000000*(x**2 + 1))</span>
<span class="sd">    (x + 2)**20000000*(x**2 + 1)</span>

<span class="sd">    By default, factor deals with an expression as a whole:</span>

<span class="sd">    &gt;&gt;&gt; eq = 2**(x**2 + 2*x + 1)</span>
<span class="sd">    &gt;&gt;&gt; factor(eq)</span>
<span class="sd">    2**(x**2 + 2*x + 1)</span>

<span class="sd">    If the ``deep`` flag is True then subexpressions will</span>
<span class="sd">    be factored:</span>

<span class="sd">    &gt;&gt;&gt; factor(eq, deep=True)</span>
<span class="sd">    2**((x + 1)**2)</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    sympy.ntheory.factor_.factorint</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;deep&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
        <span class="n">partials</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">muladd</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Mul</span><span class="p">,</span> <span class="n">Add</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">muladd</span><span class="p">:</span>
            <span class="n">fac</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">is_Mul</span> <span class="ow">or</span> <span class="n">fac</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fac</span> <span class="o">!=</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">partials</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">fac</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">xreplace</span><span class="p">(</span><span class="n">partials</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_generic_factor</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;factor&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolynomialError</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">sympy.core.exprtools</span> <span class="kn">import</span> <span class="n">factor_nc</span>
            <span class="k">return</span> <span class="n">factor_nc</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="intervals"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.intervals">[docs]</a><span class="k">def</span> <span class="nf">intervals</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">inf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sqf</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute isolating intervals for roots of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import intervals</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; intervals(x**2 - 3)</span>
<span class="sd">    [((-2, -1), 1), ((1, 2), 1)]</span>
<span class="sd">    &gt;&gt;&gt; intervals(x**2 - 3, eps=1e-2)</span>
<span class="sd">    [((-26/15, -19/11), 1), ((19/11, 26/15), 1)]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">GeneratorsNeeded</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">intervals</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="nb">all</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">inf</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="n">sup</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">,</span> <span class="n">sqf</span><span class="o">=</span><span class="n">sqf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">polys</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">&#39;QQ&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultivariatePolynomialError</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">poly</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polys</span><span class="p">):</span>
            <span class="n">polys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">rep</span>

        <span class="k">if</span> <span class="n">eps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">eps</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">eps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;&#39;eps&#39; must be a positive rational&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">inf</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sup</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">sup</span><span class="p">)</span>

        <span class="n">intervals</span> <span class="o">=</span> <span class="n">dup_isolate_real_roots_list</span><span class="p">(</span><span class="n">polys</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span>
            <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">inf</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="n">sup</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">indices</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="refine_root"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.refine_root">[docs]</a><span class="k">def</span> <span class="nf">refine_root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">check_sqf</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Refine an isolating interval of a root to the given precision.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import refine_root</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; refine_root(x**2 - 3, 1, 2, eps=1e-2)</span>
<span class="sd">    (19/11, 26/15)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">GeneratorsNeeded</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span>
            <span class="s">&quot;can&#39;t refine a root of </span><span class="si">%s</span><span class="s">, not a polynomial&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">refine_root</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">,</span> <span class="n">check_sqf</span><span class="o">=</span><span class="n">check_sqf</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="count_roots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.count_roots">[docs]</a><span class="k">def</span> <span class="nf">count_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">inf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the number of roots of ``f`` in ``[inf, sup]`` interval.</span>

<span class="sd">    If one of ``inf`` or ``sup`` is complex, it will return the number of roots</span>
<span class="sd">    in the complex rectangle with corners at ``inf`` and ``sup``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import count_roots, I</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; count_roots(x**4 - 4, -3, 3)</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; count_roots(x**4 - 4, 0, 1 + 3*I)</span>
<span class="sd">    1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">GeneratorsNeeded</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="s">&quot;can&#39;t count roots of </span><span class="si">%s</span><span class="s">, not a polynomial&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">count_roots</span><span class="p">(</span><span class="n">inf</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="o">=</span><span class="n">sup</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="real_roots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.real_roots">[docs]</a><span class="k">def</span> <span class="nf">real_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a list of real roots with multiplicities of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import real_roots</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; real_roots(2*x**3 - 7*x**2 + 4*x + 4)</span>
<span class="sd">    [-1/2, 2, 2]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">GeneratorsNeeded</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span>
            <span class="s">&quot;can&#39;t compute real roots of </span><span class="si">%s</span><span class="s">, not a polynomial&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">real_roots</span><span class="p">(</span><span class="n">multiple</span><span class="o">=</span><span class="n">multiple</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="nroots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.nroots">[docs]</a><span class="k">def</span> <span class="nf">nroots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">maxsteps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cleanup</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute numerical approximations of roots of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import nroots</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; nroots(x**2 - 3, n=15)</span>
<span class="sd">    [-1.73205080756888, 1.73205080756888]</span>
<span class="sd">    &gt;&gt;&gt; nroots(x**2 - 3, n=30)</span>
<span class="sd">    [-1.73205080756887729352744634151, 1.73205080756887729352744634151]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">GeneratorsNeeded</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span>
            <span class="s">&quot;can&#39;t compute numerical roots of </span><span class="si">%s</span><span class="s">, not a polynomial&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">nroots</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">maxsteps</span><span class="o">=</span><span class="n">maxsteps</span><span class="p">,</span> <span class="n">cleanup</span><span class="o">=</span><span class="n">cleanup</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="ground_roots"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.ground_roots">[docs]</a><span class="k">def</span> <span class="nf">ground_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute roots of ``f`` by factorization in the ground domain.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import ground_roots</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; ground_roots(x**6 - 4*x**4 + 4*x**3 - x**2)</span>
<span class="sd">    {0: 2, 1: 2}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;ground_roots&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">ground_roots</span><span class="p">()</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="nth_power_roots_poly"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.nth_power_roots_poly">[docs]</a><span class="k">def</span> <span class="nf">nth_power_roots_poly</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Construct a polynomial with n-th powers of roots of ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import nth_power_roots_poly, factor, roots</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; f = x**4 - x**2 + 1</span>
<span class="sd">    &gt;&gt;&gt; g = factor(nth_power_roots_poly(f, 2))</span>

<span class="sd">    &gt;&gt;&gt; g</span>
<span class="sd">    (x**2 - x + 1)**2</span>

<span class="sd">    &gt;&gt;&gt; R_f = [ (r**2).expand() for r in roots(f) ]</span>
<span class="sd">    &gt;&gt;&gt; R_g = roots(g).keys()</span>

<span class="sd">    &gt;&gt;&gt; set(R_f) == set(R_g)</span>
<span class="sd">    True</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">poly_from_expr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;nth_power_roots_poly&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nth_power_roots_poly</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="cancel"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.cancel">[docs]</a><span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel common factors in a rational function ``f``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import cancel, sqrt, Symbol</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>
<span class="sd">    &gt;&gt;&gt; A = Symbol(&#39;A&#39;, commutative=False)</span>

<span class="sd">    &gt;&gt;&gt; cancel((2*x**2 - 2)/(x**2 - 2*x + 1))</span>
<span class="sd">    (2*x + 2)/(x - 1)</span>
<span class="sd">    &gt;&gt;&gt; cancel((sqrt(3) + sqrt(15)*A)/(sqrt(2) + sqrt(10)*A))</span>
<span class="sd">    sqrt(6)/2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sympy.core.exprtools</span> <span class="kn">import</span> <span class="n">factor_terms</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">])</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_Number</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Relational</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">factor_terms</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">radical</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">()</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">f</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">factor_terms</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;unexpected argument: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">f</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span>
    <span class="k">except</span> <span class="n">PolynomialError</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_commutative</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Piecewise</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">PolynomialError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c"># Handling of noncommutative and/or piecewise expressions</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
            <span class="n">sifted</span> <span class="o">=</span> <span class="n">sift</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">is_commutative</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Piecewise</span><span class="p">))</span>
            <span class="n">c</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">sifted</span><span class="p">[</span><span class="bp">True</span><span class="p">],</span> <span class="n">sifted</span><span class="p">[</span><span class="bp">False</span><span class="p">]</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="p">[</span><span class="n">cancel</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nc</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">cancel</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">_from_args</span><span class="p">(</span><span class="n">c</span><span class="p">)),</span> <span class="o">*</span><span class="n">nc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reps</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">pot</span> <span class="o">=</span> <span class="n">preorder_traversal</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">next</span><span class="p">(</span><span class="n">pot</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">pot</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">reps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e</span><span class="p">,</span> <span class="n">cancel</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
                    <span class="n">pot</span><span class="o">.</span><span class="n">skip</span><span class="p">()</span>  <span class="c"># this was handled successfully</span>
                <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">xreplace</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">reps</span><span class="p">))</span>

    <span class="n">c</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span><span class="o">/</span><span class="n">Q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">Q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Q</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="reduced"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.reduced">[docs]</a><span class="k">def</span> <span class="nf">reduced</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reduces a polynomial ``f`` modulo a set of polynomials ``G``.</span>

<span class="sd">    Given a polynomial ``f`` and a set of polynomials ``G = (g_1, ..., g_n)``,</span>
<span class="sd">    computes a set of quotients ``q = (q_1, ..., q_n)`` and the remainder ``r``</span>
<span class="sd">    such that ``f = q_1*f_1 + ... + q_n*f_n + r``, where ``r`` vanishes or ``r``</span>
<span class="sd">    is a completely reduced polynomial with respect to ``G``.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import reduced</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; reduced(2*x**4 + y**2 - x**2 + y**3, [x**3 - x, y**3 - y])</span>
<span class="sd">    ([2*x, 1], x**2 + y**2 + y)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">,</span> <span class="s">&#39;auto&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">polys</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">([</span><span class="n">f</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;reduced&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>

    <span class="n">domain</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span>
    <span class="n">retract</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">auto</span> <span class="ow">and</span> <span class="n">domain</span><span class="o">.</span><span class="n">has_Ring</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">domain</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="o">.</span><span class="n">get_field</span><span class="p">()))</span>
        <span class="n">retract</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="kn">from</span> <span class="nn">sympy.polys.rings</span> <span class="kn">import</span> <span class="n">xring</span>
    <span class="n">_ring</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">xring</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">poly</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polys</span><span class="p">):</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">)</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">polys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ring</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

    <span class="n">Q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">polys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">polys</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

    <span class="n">Q</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span> <span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">retract</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_Q</span><span class="p">,</span> <span class="n">_r</span> <span class="o">=</span> <span class="p">[</span> <span class="n">q</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span> <span class="p">],</span> <span class="n">r</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">_r</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span> <span class="p">],</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Q</span><span class="p">,</span> <span class="n">r</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="groebner"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.groebner">[docs]</a><span class="k">def</span> <span class="nf">groebner</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the reduced Groebner basis for a set of polynomials.</span>

<span class="sd">    Use the ``order`` argument to set the monomial ordering that will be</span>
<span class="sd">    used to compute the basis. Allowed orders are ``lex``, ``grlex`` and</span>
<span class="sd">    ``grevlex``. If no order is specified, it defaults to ``lex``.</span>

<span class="sd">    For more information on Groebner bases, see the references and the docstring</span>
<span class="sd">    of `solve_poly_system()`.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    Example taken from [1].</span>

<span class="sd">    &gt;&gt;&gt; from sympy import groebner</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    &gt;&gt;&gt; F = [x*y - 2*y, 2*y**2 - x**2]</span>

<span class="sd">    &gt;&gt;&gt; groebner(F, x, y, order=&#39;lex&#39;)</span>
<span class="sd">    GroebnerBasis([x**2 - 2*y**2, x*y - 2*y, y**3 - 2*y], x, y,</span>
<span class="sd">                  domain=&#39;ZZ&#39;, order=&#39;lex&#39;)</span>
<span class="sd">    &gt;&gt;&gt; groebner(F, x, y, order=&#39;grlex&#39;)</span>
<span class="sd">    GroebnerBasis([y**3 - 2*y, x**2 - 2*y**2, x*y - 2*y], x, y,</span>
<span class="sd">                  domain=&#39;ZZ&#39;, order=&#39;grlex&#39;)</span>
<span class="sd">    &gt;&gt;&gt; groebner(F, x, y, order=&#39;grevlex&#39;)</span>
<span class="sd">    GroebnerBasis([y**3 - 2*y, x**2 - 2*y**2, x*y - 2*y], x, y,</span>
<span class="sd">                  domain=&#39;ZZ&#39;, order=&#39;grevlex&#39;)</span>

<span class="sd">    By default, an improved implementation of the Buchberger algorithm is</span>
<span class="sd">    used. Optionally, an implementation of the F5B algorithm can be used.</span>
<span class="sd">    The algorithm can be set using ``method`` flag or with the :func:`setup`</span>
<span class="sd">    function from :mod:`sympy.polys.polyconfig`:</span>

<span class="sd">    &gt;&gt;&gt; F = [x**2 - x - 1, (2*x - 1) * y - (x**10 - (1 - x)**10)]</span>

<span class="sd">    &gt;&gt;&gt; groebner(F, x, y, method=&#39;buchberger&#39;)</span>
<span class="sd">    GroebnerBasis([x**2 - x - 1, y - 55], x, y, domain=&#39;ZZ&#39;, order=&#39;lex&#39;)</span>
<span class="sd">    &gt;&gt;&gt; groebner(F, x, y, method=&#39;f5b&#39;)</span>
<span class="sd">    GroebnerBasis([x**2 - x - 1, y - 55], x, y, domain=&#39;ZZ&#39;, order=&#39;lex&#39;)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    1. [Buchberger01]_</span>
<span class="sd">    2. [Cox97]_</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">GroebnerBasis</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="is_zero_dimensional"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.is_zero_dimensional">[docs]</a><span class="k">def</span> <span class="nf">is_zero_dimensional</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the ideal generated by a Groebner basis is zero-dimensional.</span>

<span class="sd">    The algorithm checks if the set of monomials not divisible by the</span>
<span class="sd">    leading monomial of any element of ``F`` is bounded.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    David A. Cox, John B. Little, Donal O&#39;Shea. Ideals, Varieties and</span>
<span class="sd">    Algorithms, 3rd edition, p. 230</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">GroebnerBasis</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero_dimensional</span>
</div>
<span class="nd">@public</span>
<div class="viewcode-block" id="GroebnerBasis"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.GroebnerBasis">[docs]</a><span class="k">class</span> <span class="nc">GroebnerBasis</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a reduced Groebner basis. &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute a reduced Groebner basis for a system of polynomials. &quot;&quot;&quot;</span>
        <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;polys&#39;</span><span class="p">,</span> <span class="s">&#39;method&#39;</span><span class="p">])</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">polys</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">parallel_poly_from_expr</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">PolificationFailed</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ComputationFailed</span><span class="p">(</span><span class="s">&#39;groebner&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">),</span> <span class="n">exc</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">sympy.polys.rings</span> <span class="kn">import</span> <span class="n">PolyRing</span>
        <span class="n">ring</span> <span class="o">=</span> <span class="n">PolyRing</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">poly</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polys</span><span class="p">):</span>
            <span class="n">polys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ring</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

        <span class="n">G</span> <span class="o">=</span> <span class="n">_groebner</span><span class="p">(</span><span class="n">polys</span><span class="p">,</span> <span class="n">ring</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span> <span class="p">]</span>

        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_new</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_new</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">Basic</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">_basis</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="n">options</span>

        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Tuple</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">),</span> <span class="n">Tuple</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">gens</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exprs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">poly</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span> <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">polys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gens</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">gens</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">domain</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">order</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polys</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exprs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
            <span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polys</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exprs</span>

        <span class="k">return</span> <span class="n">basis</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_basis</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_options</span>
        <span class="k">elif</span> <span class="n">iterable</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">polys</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">exprs</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="GroebnerBasis.is_zero_dimensional"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.GroebnerBasis.is_zero_dimensional">[docs]</a>    <span class="k">def</span> <span class="nf">is_zero_dimensional</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the ideal generated by a Groebner basis is zero-dimensional.</span>

<span class="sd">        The algorithm checks if the set of monomials not divisible by the</span>
<span class="sd">        leading monomial of any element of ``F`` is bounded.</span>

<span class="sd">        References</span>
<span class="sd">        ==========</span>

<span class="sd">        David A. Cox, John B. Little, Donal O&#39;Shea. Ideals, Varieties and</span>
<span class="sd">        Algorithms, 3rd edition, p. 230</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">single_var</span><span class="p">(</span><span class="n">monomial</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">monomial</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>

        <span class="n">exponents</span> <span class="o">=</span> <span class="n">Monomial</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gens</span><span class="p">))</span>
        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">order</span>

        <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
            <span class="n">monomial</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">LM</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">single_var</span><span class="p">(</span><span class="n">monomial</span><span class="p">):</span>
                <span class="n">exponents</span> <span class="o">*=</span> <span class="n">monomial</span>

        <span class="c"># If any element of the exponents vector is zero, then there&#39;s</span>
        <span class="c"># a variable for which there&#39;s no degree bound and the ideal</span>
        <span class="c"># generated by this Groebner basis isn&#39;t zero-dimensional.</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">exponents</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GroebnerBasis.fglm"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.GroebnerBasis.fglm">[docs]</a>    <span class="k">def</span> <span class="nf">fglm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a Groebner basis from one ordering to another.</span>

<span class="sd">        The FGLM algorithm converts reduced Groebner bases of zero-dimensional</span>
<span class="sd">        ideals from one ordering to another. This method is often used when it</span>
<span class="sd">        is infeasible to compute a Groebner basis with respect to a particular</span>
<span class="sd">        ordering directly.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
<span class="sd">        &gt;&gt;&gt; from sympy import groebner</span>

<span class="sd">        &gt;&gt;&gt; F = [x**2 - 3*y - x + 1, y**2 - 2*x + y - 1]</span>
<span class="sd">        &gt;&gt;&gt; G = groebner(F, x, y, order=&#39;grlex&#39;)</span>

<span class="sd">        &gt;&gt;&gt; list(G.fglm(&#39;lex&#39;))</span>
<span class="sd">        [2*x - y**2 - y + 1, y**4 + 2*y**3 - 3*y**2 - 16*y + 7]</span>
<span class="sd">        &gt;&gt;&gt; list(groebner(F, x, y, order=&#39;lex&#39;))</span>
<span class="sd">        [2*x - y**2 - y + 1, y**4 + 2*y**3 - 3*y**2 - 16*y + 7]</span>

<span class="sd">        References</span>
<span class="sd">        ==========</span>

<span class="sd">        J.C. Faugere, P. Gianni, D. Lazard, T. Mora (1994). Efficient</span>
<span class="sd">        Computation of Zero-dimensional Groebner Bases by Change of</span>
<span class="sd">        Ordering</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span>

        <span class="n">src_order</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">order</span>
        <span class="n">dst_order</span> <span class="o">=</span> <span class="n">monomial_key</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">src_order</span> <span class="o">==</span> <span class="n">dst_order</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zero_dimensional</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;can&#39;t convert Groebner bases of ideals with positive dimension&quot;</span><span class="p">)</span>

        <span class="n">polys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">)</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span>

        <span class="n">opt</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="o">.</span><span class="n">get_field</span><span class="p">(),</span>
            <span class="n">order</span><span class="o">=</span><span class="n">dst_order</span><span class="p">,</span>
        <span class="p">))</span>

        <span class="kn">from</span> <span class="nn">sympy.polys.rings</span> <span class="kn">import</span> <span class="n">xring</span>
        <span class="n">_ring</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">xring</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="n">src_order</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">poly</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polys</span><span class="p">):</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">)</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="n">polys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ring</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

        <span class="n">G</span> <span class="o">=</span> <span class="n">matrix_fglm</span><span class="p">(</span><span class="n">polys</span><span class="p">,</span> <span class="n">_ring</span><span class="p">,</span> <span class="n">dst_order</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span> <span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">domain</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="n">G</span> <span class="o">=</span> <span class="p">[</span> <span class="n">g</span><span class="o">.</span><span class="n">clear_denoms</span><span class="p">(</span><span class="n">convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span> <span class="p">]</span>
            <span class="n">opt</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GroebnerBasis.reduce"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.GroebnerBasis.reduce">[docs]</a>    <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduces a polynomial modulo a Groebner basis.</span>

<span class="sd">        Given a polynomial ``f`` and a set of polynomials ``G = (g_1, ..., g_n)``,</span>
<span class="sd">        computes a set of quotients ``q = (q_1, ..., q_n)`` and the remainder ``r``</span>
<span class="sd">        such that ``f = q_1*f_1 + ... + q_n*f_n + r``, where ``r`` vanishes or ``r``</span>
<span class="sd">        is a completely reduced polynomial with respect to ``G``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import groebner, expand</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = 2*x**4 - x**2 + y**3 + y**2</span>
<span class="sd">        &gt;&gt;&gt; G = groebner([x**3 - x, y**3 - y])</span>

<span class="sd">        &gt;&gt;&gt; G.reduce(f)</span>
<span class="sd">        ([2*x, 1], x**2 + y**2 + y)</span>
<span class="sd">        &gt;&gt;&gt; Q, r = _</span>

<span class="sd">        &gt;&gt;&gt; expand(sum(q*g for q, g in zip(Q, G)) + r)</span>
<span class="sd">        2*x**4 - x**2 + y**3 + y**2</span>
<span class="sd">        &gt;&gt;&gt; _ == f</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)</span>
        <span class="n">polys</span> <span class="o">=</span> <span class="p">[</span><span class="n">poly</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">)</span>

        <span class="n">opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span>

        <span class="n">retract</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="n">auto</span> <span class="ow">and</span> <span class="n">domain</span><span class="o">.</span><span class="n">has_Ring</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">domain</span><span class="o">.</span><span class="n">has_Field</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="o">.</span><span class="n">get_field</span><span class="p">()))</span>
            <span class="n">retract</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="kn">from</span> <span class="nn">sympy.polys.rings</span> <span class="kn">import</span> <span class="n">xring</span>
        <span class="n">_ring</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">xring</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">gens</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">poly</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polys</span><span class="p">):</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">domain</span><span class="p">)</span><span class="o">.</span><span class="n">rep</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="n">polys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ring</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

        <span class="n">Q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">polys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">polys</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="n">Q</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span> <span class="p">]</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">retract</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_Q</span><span class="p">,</span> <span class="n">_r</span> <span class="o">=</span> <span class="p">[</span> <span class="n">q</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span> <span class="p">],</span> <span class="n">r</span><span class="o">.</span><span class="n">to_ring</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">CoercionFailed</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">_r</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">polys</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span> <span class="n">q</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span> <span class="p">],</span> <span class="n">r</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Q</span><span class="p">,</span> <span class="n">r</span>
</div>
<div class="viewcode-block" id="GroebnerBasis.contains"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.GroebnerBasis.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if ``poly`` belongs the ideal generated by ``self``.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy import groebner</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">        &gt;&gt;&gt; f = 2*x**3 + y**3 + 3*y</span>
<span class="sd">        &gt;&gt;&gt; G = groebner([x**2 + y**2 - 1, x*y - 2])</span>

<span class="sd">        &gt;&gt;&gt; G.contains(f)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; G.contains(f + 1)</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">poly</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>

</div></div>
<span class="nd">@public</span>
<div class="viewcode-block" id="poly"><a class="viewcode-back" href="../../../modules/polys/reference.html#sympy.polys.polytools.poly">[docs]</a><span class="k">def</span> <span class="nf">poly</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Efficiently transform an expression into a polynomial.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import poly</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    &gt;&gt;&gt; poly(x*(x**2 + x - 1)**2)</span>
<span class="sd">    Poly(x**5 + 2*x**4 - x**3 - 2*x**2 + x, x, domain=&#39;ZZ&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="o">.</span><span class="n">allowed_flags</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">def</span> <span class="nf">_poly</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="n">terms</span><span class="p">,</span> <span class="n">poly_terms</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
            <span class="n">factors</span><span class="p">,</span> <span class="n">poly_factors</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">term</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">factor</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
                    <span class="n">poly_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_poly</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">opt</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">factor</span><span class="o">.</span><span class="n">is_Pow</span> <span class="ow">and</span> <span class="n">factor</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">and</span> <span class="n">factor</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
                    <span class="n">poly_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">_poly</span><span class="p">(</span><span class="n">factor</span><span class="o">.</span><span class="n">base</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">factor</span><span class="o">.</span><span class="n">exp</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">poly_factors</span><span class="p">:</span>
                <span class="n">terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">product</span> <span class="o">=</span> <span class="n">poly_factors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">poly_factors</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                    <span class="n">product</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">factors</span><span class="p">:</span>
                    <span class="n">factor</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">factors</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">factor</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
                        <span class="n">product</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">product</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">Poly</span><span class="o">.</span><span class="n">_from_expr</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">opt</span><span class="p">))</span>

                <span class="n">poly_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">poly_terms</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Poly</span><span class="o">.</span><span class="n">_from_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">poly_terms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">poly_terms</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">terms</span><span class="p">:</span>
                <span class="n">term</span> <span class="o">=</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">terms</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Poly</span><span class="o">.</span><span class="n">_from_expr</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">opt</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="o">*</span><span class="n">opt</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;gens&#39;</span><span class="p">,</span> <span class="p">()),</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

    <span class="n">expr</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Poly</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="s">&#39;expand&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">args</span><span class="p">[</span><span class="s">&#39;expand&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="n">opt</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">build_options</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_poly</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
</div>
<span class="kn">from</span> <span class="nn">sympy.functions</span> <span class="kn">import</span> <span class="n">Piecewise</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">SymPy 0.7.3 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../sympy.html" >sympy</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013 SymPy Development Team.
      Last updated on Aug 04, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>