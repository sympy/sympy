

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sympy.combinatorics.partitions &mdash; SymPy 0.7.3 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-autocomplete.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.7.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/SymPy-Favicon.ico"/>
    <link rel="top" title="SymPy 0.7.3 documentation" href="../../../index.html" />
    <link rel="up" title="sympy.combinatorics" href="../combinatorics.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">SymPy 0.7.3 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../sympy.html" >sympy</a> &raquo;</li>
          <li><a href="../combinatorics.html" accesskey="U">sympy.combinatorics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for sympy.combinatorics.partitions</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">sympy.core</span> <span class="kn">import</span> <span class="n">Basic</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">sympify</span>
<span class="kn">from</span> <span class="nn">sympy.core.compatibility</span> <span class="kn">import</span> <span class="n">as_int</span><span class="p">,</span> <span class="n">default_sort_key</span><span class="p">,</span> <span class="nb">xrange</span>
<span class="kn">from</span> <span class="nn">sympy.functions.combinatorial.numbers</span> <span class="kn">import</span> <span class="n">bell</span>
<span class="kn">from</span> <span class="nn">sympy.matrices</span> <span class="kn">import</span> <span class="n">zeros</span>
<span class="kn">from</span> <span class="nn">sympy.utilities.iterables</span> <span class="kn">import</span> <span class="n">has_dups</span><span class="p">,</span> <span class="n">flatten</span><span class="p">,</span> <span class="n">group</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>


<div class="viewcode-block" id="Partition"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.Partition">[docs]</a><span class="k">class</span> <span class="nc">Partition</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">FiniteSet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents an abstract partition.</span>

<span class="sd">    A partition is a set of disjoint sets whose union equals a given set.</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    sympy.utilities.iterables.partitions,</span>
<span class="sd">    sympy.utilities.iterables.multiset_partitions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_rank</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_partition</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">partition</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a new partition object.</span>

<span class="sd">        This method also verifies if the arguments passed are</span>
<span class="sd">        valid and raises a ValueError if they are not.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 2], [3]])</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        {{1, 2}, {3}}</span>
<span class="sd">        &gt;&gt;&gt; a.partition</span>
<span class="sd">        [[1, 2], [3]]</span>
<span class="sd">        &gt;&gt;&gt; len(a)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; a.members</span>
<span class="sd">        (1, 2, 3)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">partition</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">args</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Partition should be a list of lists.&quot;</span><span class="p">)</span>

        <span class="c"># sort so we have a canonical reference for RGS</span>
        <span class="n">partition</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="p">[]),</span> <span class="n">key</span><span class="o">=</span><span class="n">default_sort_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_dups</span><span class="p">(</span><span class="n">partition</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Partition contained duplicated elements.&quot;</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">FiniteSet</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">FiniteSet</span><span class="p">,</span> <span class="n">args</span><span class="p">)))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

<div class="viewcode-block" id="Partition.sort_key"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.Partition.sort_key">[docs]</a>    <span class="k">def</span> <span class="nf">sort_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a canonical key that can be used for sorting.</span>

<span class="sd">        Ordering is based on the size and sorted elements of the partition</span>
<span class="sd">        and ties are broken with the rank.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.utilities.iterables import default_sort_key</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 2]])</span>
<span class="sd">        &gt;&gt;&gt; b = Partition([[3, 4]])</span>
<span class="sd">        &gt;&gt;&gt; c = Partition([[1, x]])</span>
<span class="sd">        &gt;&gt;&gt; d = Partition([list(range(4))])</span>
<span class="sd">        &gt;&gt;&gt; l = [d, b, a + 1, a, c]</span>
<span class="sd">        &gt;&gt;&gt; l.sort(key=default_sort_key); l</span>
<span class="sd">        [{{1, 2}}, {{1}, {2}}, {{1, x}}, {{3, 4}}, {{0, 1, 2, 3}}]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">members</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">members</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">,</span>
                             <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">default_sort_key</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">order</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">members</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Partition.partition"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.Partition.partition">[docs]</a>    <span class="k">def</span> <span class="nf">partition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return partition as a sorted list of lists.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; Partition([[1], [2, 3]]).partition</span>
<span class="sd">        [[1], [2, 3]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partition</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_partition</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partition</span>
</div>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return permutation whose rank is ``other`` greater than current rank,</span>
<span class="sd">        (mod the maximum rank for the set).</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 2], [3]])</span>
<span class="sd">        &gt;&gt;&gt; a.rank</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; (a + 1).rank</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; (a + 100).rank</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span> <span class="o">+</span> <span class="n">other</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">RGS_unrank</span><span class="p">((</span><span class="n">offset</span><span class="p">)</span> <span class="o">%</span>
                            <span class="n">RGS_enum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Partition</span><span class="o">.</span><span class="n">from_rgs</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return permutation whose rank is ``other`` less than current rank,</span>
<span class="sd">        (mod the maximum rank for the set).</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 2], [3]])</span>
<span class="sd">        &gt;&gt;&gt; a.rank</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; (a - 1).rank</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; (a - 100).rank</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if a partition is less than or equal to</span>
<span class="sd">        the other based on rank.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 2], [3, 4, 5]])</span>
<span class="sd">        &gt;&gt;&gt; b = Partition([[1], [2, 3], [4], [5]])</span>
<span class="sd">        &gt;&gt;&gt; a.rank, b.rank</span>
<span class="sd">        (9, 34)</span>
<span class="sd">        &gt;&gt;&gt; a &lt;= a</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; a &lt;= b</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_key</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">sort_key</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if a partition is less than the other.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 2], [3, 4, 5]])</span>
<span class="sd">        &gt;&gt;&gt; b = Partition([[1], [2, 3], [4], [5]])</span>
<span class="sd">        &gt;&gt;&gt; a.rank, b.rank</span>
<span class="sd">        (9, 34)</span>
<span class="sd">        &gt;&gt;&gt; a &lt; b</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_key</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">sympify</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">sort_key</span><span class="p">()</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Partition.rank"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.Partition.rank">[docs]</a>    <span class="k">def</span> <span class="nf">rank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the rank of a partition.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 2], [3], [4, 5]])</span>
<span class="sd">        &gt;&gt;&gt; a.rank</span>
<span class="sd">        13</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">=</span> <span class="n">RGS_rank</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RGS</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Partition.RGS"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.Partition.RGS">[docs]</a>    <span class="k">def</span> <span class="nf">RGS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the &quot;restricted growth string&quot; of the partition.</span>

<span class="sd">        The RGS is returned as a list of indices, L, where L[i] indicates</span>
<span class="sd">        the block in which element i appears. For example, in a partition</span>
<span class="sd">        of 3 elements (a, b, c) into 2 blocks ([c], [a, b]) the RGS is</span>
<span class="sd">        [1, 1, 0]: &quot;a&quot; is in block 1, &quot;b&quot; is in block 1 and &quot;c&quot; is in block 0.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 2], [3], [4, 5]])</span>
<span class="sd">        &gt;&gt;&gt; a.members</span>
<span class="sd">        (1, 2, 3, 4, 5)</span>
<span class="sd">        &gt;&gt;&gt; a.RGS</span>
<span class="sd">        (0, 0, 1, 2, 2)</span>
<span class="sd">        &gt;&gt;&gt; a + 1</span>
<span class="sd">        {{1, 2}, {3}, {4}, {5}}</span>
<span class="sd">        &gt;&gt;&gt; _.RGS</span>
<span class="sd">        (0, 0, 1, 2, 3)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rgs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">partition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">partition</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">part</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">partition</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">part</span><span class="p">:</span>
                <span class="n">rgs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">rgs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">partition</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">)])</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Partition.from_rgs"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.Partition.from_rgs">[docs]</a>    <span class="k">def</span> <span class="nf">from_rgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rgs</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a set partition from a restricted growth string.</span>

<span class="sd">        The indices given in rgs are assumed to be the index</span>
<span class="sd">        of the element as given in elements *as provided* (the</span>
<span class="sd">        elements are not sorted by this routine). Block numbering</span>
<span class="sd">        starts from 0. If any block was not referenced in ``rgs``</span>
<span class="sd">        an error will be raised.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">        &gt;&gt;&gt; Partition.from_rgs([0, 1, 2, 0, 1], list(&#39;abcde&#39;))</span>
<span class="sd">        {{c}, {a, d}, {b, e}}</span>
<span class="sd">        &gt;&gt;&gt; Partition.from_rgs([0, 1, 2, 0, 1], list(&#39;cbead&#39;))</span>
<span class="sd">        {{e}, {a, c}, {b, d}}</span>
<span class="sd">        &gt;&gt;&gt; a = Partition([[1, 4], [2], [3, 5]])</span>
<span class="sd">        &gt;&gt;&gt; Partition.from_rgs(a.RGS, a.members)</span>
<span class="sd">        {{1, 4}, {2}, {3, 5}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;mismatch in rgs and element lengths&#39;</span><span class="p">)</span>
        <span class="n">max_elem</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rgs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">partition</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">max_elem</span><span class="p">)]</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rgs</span><span class="p">:</span>
            <span class="n">partition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;some blocks of the partition were empty.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Partition</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="IntegerPartition"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.IntegerPartition">[docs]</a><span class="k">class</span> <span class="nc">IntegerPartition</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents an integer partition.</span>

<span class="sd">    In number theory and combinatorics, a partition of a positive integer,</span>
<span class="sd">    ``n``, also called an integer partition, is a way of writing ``n`` as a</span>
<span class="sd">    list of positive integers that sum to n. Two partitions that differ only</span>
<span class="sd">    in the order of summands are considered to be the same partition; if order</span>
<span class="sd">    matters then the partitions are referred to as compositions. For example,</span>
<span class="sd">    4 has five partitions: [4], [3, 1], [2, 2], [2, 1, 1], and [1, 1, 1, 1];</span>
<span class="sd">    the compositions [1, 2, 1] and [1, 1, 2] are the same as partition</span>
<span class="sd">    [2, 1, 1].</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    sympy.utilities.iterables.partitions,</span>
<span class="sd">    sympy.utilities.iterables.multiset_partitions</span>

<span class="sd">    Reference: http://en.wikipedia.org/wiki/Partition_%28number_theory%29</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_dict</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_keys</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">partition</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a new IntegerPartition object from a list or dictionary.</span>

<span class="sd">        The partition can be given as a list of positive integers or a</span>
<span class="sd">        dictionary of (integer, multiplicity) items. If the partition is</span>
<span class="sd">        preceeded by an integer an error will be raised if the partition</span>
<span class="sd">        does not sum to that given integer.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import IntegerPartition</span>
<span class="sd">        &gt;&gt;&gt; a = IntegerPartition([5, 4, 3, 1, 1])</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        IntegerPartition(14, (5, 4, 3, 1, 1))</span>
<span class="sd">        &gt;&gt;&gt; print(a)</span>
<span class="sd">        [5, 4, 3, 1, 1]</span>
<span class="sd">        &gt;&gt;&gt; IntegerPartition({1:3, 2:1})</span>
<span class="sd">        IntegerPartition(5, (2, 1, 1, 1))</span>

<span class="sd">        If the value that the partion should sum to is given first, a check</span>
<span class="sd">        will be made to see n error will be raised if there is a discrepancy:</span>
<span class="sd">        &gt;&gt;&gt; IntegerPartition(10, [5, 4, 3, 1])</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The partition is not valid</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">integer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">integer</span><span class="p">,</span> <span class="n">partition</span> <span class="o">=</span> <span class="n">partition</span><span class="p">,</span> <span class="n">integer</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">Dict</span><span class="p">)):</span>
            <span class="n">_</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">as_int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">_</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
            <span class="n">partition</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">partition</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">as_int</span><span class="p">,</span> <span class="n">partition</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
        <span class="n">sum_ok</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">integer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">integer</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
            <span class="n">sum_ok</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">integer</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">integer</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sum_ok</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span> <span class="o">!=</span> <span class="n">integer</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Partition did not add to </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">integer</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The summands must all be positive.&quot;</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">Basic</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="n">partition</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">partition</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">integer</span> <span class="o">=</span> <span class="n">integer</span>
        <span class="k">return</span> <span class="n">obj</span>

<div class="viewcode-block" id="IntegerPartition.prev_lex"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.IntegerPartition.prev_lex">[docs]</a>    <span class="k">def</span> <span class="nf">prev_lex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the previous partition of the integer, n, in lexical order,</span>
<span class="sd">        wrapping around to [1, ..., 1] if the partition is [n].</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import IntegerPartition</span>
<span class="sd">        &gt;&gt;&gt; p = IntegerPartition([4])</span>
<span class="sd">        &gt;&gt;&gt; print(p.prev_lex())</span>
<span class="sd">        [3, 1]</span>
<span class="sd">        &gt;&gt;&gt; p.partition &gt; p.prev_lex().partition</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span>
        <span class="k">if</span> <span class="n">keys</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">IntegerPartition</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">integer</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">left</span><span class="p">:</span>
                <span class="n">new</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">left</span> <span class="o">-</span> <span class="n">new</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">new</span><span class="p">]</span> <span class="o">+=</span> <span class="n">left</span><span class="o">//</span><span class="n">new</span>
                    <span class="n">left</span> <span class="o">-=</span> <span class="n">d</span><span class="p">[</span><span class="n">new</span><span class="p">]</span><span class="o">*</span><span class="n">new</span>
        <span class="k">return</span> <span class="n">IntegerPartition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IntegerPartition.next_lex"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.IntegerPartition.next_lex">[docs]</a>    <span class="k">def</span> <span class="nf">next_lex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the next partition of the integer, n, in lexical order,</span>
<span class="sd">        wrapping around to [n] if the partition is [1, ..., 1].</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import IntegerPartition</span>
<span class="sd">        &gt;&gt;&gt; p = IntegerPartition([3, 1])</span>
<span class="sd">        &gt;&gt;&gt; print(p.next_lex())</span>
<span class="sd">        [4]</span>
<span class="sd">        &gt;&gt;&gt; p.partition &lt; p.next_lex().partition</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">integer</span><span class="p">:</span>
            <span class="n">d</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">integer</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">d</span><span class="p">[</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">b</span>
                <span class="n">d</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">integer</span> <span class="o">-</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">a1</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="n">a1</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">b1</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">d</span><span class="p">[</span><span class="n">b1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">need</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="n">b1</span>
                <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">need</span>
        <span class="k">return</span> <span class="n">IntegerPartition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IntegerPartition.as_dict"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.IntegerPartition.as_dict">[docs]</a>    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the partition as a dictionary whose keys are the</span>
<span class="sd">        partition integers and the values are the multiplicity of that</span>
<span class="sd">        integer.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import IntegerPartition</span>
<span class="sd">        &gt;&gt;&gt; IntegerPartition([1]*3 + [2] + [3]*4).as_dict()</span>
<span class="sd">        {1: 3, 2: 1, 3: 4}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="IntegerPartition.conjugate"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.IntegerPartition.conjugate">[docs]</a>    <span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the conjugate partition of itself.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import IntegerPartition</span>
<span class="sd">        &gt;&gt;&gt; a = IntegerPartition([6, 3, 3, 2, 1])</span>
<span class="sd">        &gt;&gt;&gt; a.conjugate</span>
<span class="sd">        [5, 4, 3, 1, 1, 1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">temp_arr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">temp_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">k</span>
        <span class="k">while</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">temp_arr</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="n">b</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
                <span class="n">k</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">b</span>
</div>
    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is less than other when the partition</span>
<span class="sd">        is listed from smallest to biggest.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import IntegerPartition</span>
<span class="sd">        &gt;&gt;&gt; a = IntegerPartition([3, 1])</span>
<span class="sd">        &gt;&gt;&gt; a &lt; a</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; b = a.next_lex()</span>
<span class="sd">        &gt;&gt;&gt; a &lt; b</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; a == b</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">))</span> <span class="o">&lt;</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">partition</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if self is less than other when the partition</span>
<span class="sd">        is listed from smallest to biggest.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import IntegerPartition</span>
<span class="sd">        &gt;&gt;&gt; a = IntegerPartition([4])</span>
<span class="sd">        &gt;&gt;&gt; a &lt;= a</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">partition</span><span class="p">))</span>

<div class="viewcode-block" id="IntegerPartition.as_ferrers"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.IntegerPartition.as_ferrers">[docs]</a>    <span class="k">def</span> <span class="nf">as_ferrers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="s">&#39;#&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the ferrer diagram of a partition.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.partitions import IntegerPartition</span>
<span class="sd">        &gt;&gt;&gt; print(IntegerPartition([1, 1, 5]).as_ferrers())</span>
<span class="sd">        #####</span>
<span class="sd">        #</span>
<span class="sd">        #</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">char</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">])</span>
</div>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="random_integer_partition"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.random_integer_partition">[docs]</a><span class="k">def</span> <span class="nf">random_integer_partition</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a random integer partition summing to ``n`` as a list</span>
<span class="sd">    of reverse-sorted integers.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.partitions import random_integer_partition</span>

<span class="sd">    For the following, a seed is given so a known value can be shown; in</span>
<span class="sd">    practice, the seed would not be given.</span>

<span class="sd">    &gt;&gt;&gt; random_integer_partition(100, seed=[1, 1, 12, 1, 2, 1, 85, 1])</span>
<span class="sd">    [85, 12, 2, 1]</span>
<span class="sd">    &gt;&gt;&gt; random_integer_partition(10, seed=[1, 2, 3, 1, 5, 1])</span>
<span class="sd">    [5, 3, 1, 1]</span>
<span class="sd">    &gt;&gt;&gt; random_integer_partition(1)</span>
<span class="sd">    [1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sympy.utilities.randtest</span> <span class="kn">import</span> <span class="n">_randint</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;n must be a positive integer&#39;</span><span class="p">)</span>

    <span class="n">randint</span> <span class="o">=</span> <span class="n">_randint</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">partition</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">mult</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">//</span><span class="n">k</span><span class="p">)</span>
        <span class="n">partition</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">mult</span><span class="p">))</span>
        <span class="n">n</span> <span class="o">-=</span> <span class="n">k</span><span class="o">*</span><span class="n">mult</span>
    <span class="n">partition</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">partition</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">([[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">m</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">partition</span>

</div>
<div class="viewcode-block" id="RGS_generalized"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.RGS_generalized">[docs]</a><span class="k">def</span> <span class="nf">RGS_generalized</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the m + 1 generalized unrestricted growth strings</span>
<span class="sd">    and returns them as rows in matrix.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.partitions import RGS_generalized</span>
<span class="sd">    &gt;&gt;&gt; RGS_generalized(6)</span>
<span class="sd">    Matrix([</span>
<span class="sd">    [  1,   1,   1,  1,  1, 1, 1],</span>
<span class="sd">    [  1,   2,   3,  4,  5, 6, 0],</span>
<span class="sd">    [  2,   5,  10, 17, 26, 0, 0],</span>
<span class="sd">    [  5,  15,  37, 77,  0, 0, 0],</span>
<span class="sd">    [ 15,  52, 151,  0,  0, 0, 0],</span>
<span class="sd">    [ 52, 203,   0,  0,  0, 0, 0],</span>
<span class="sd">    [203,   0,   0,  0,  0, 0, 0]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span> <span class="o">-</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> <span class="o">*</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">d</span>

</div>
<div class="viewcode-block" id="RGS_enum"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.RGS_enum">[docs]</a><span class="k">def</span> <span class="nf">RGS_enum</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RGS_enum computes the total number of restricted growth strings</span>
<span class="sd">    possible for a superset of size m.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.partitions import RGS_enum</span>
<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.partitions import Partition</span>
<span class="sd">    &gt;&gt;&gt; RGS_enum(4)</span>
<span class="sd">    15</span>
<span class="sd">    &gt;&gt;&gt; RGS_enum(5)</span>
<span class="sd">    52</span>
<span class="sd">    &gt;&gt;&gt; RGS_enum(6)</span>
<span class="sd">    203</span>

<span class="sd">    We can check that the enumeration is correct by actually generating</span>
<span class="sd">    the partitions. Here, the 15 partitions of 4 items are generated:</span>

<span class="sd">    &gt;&gt;&gt; a = Partition([list(range(4))])</span>
<span class="sd">    &gt;&gt;&gt; s = set()</span>
<span class="sd">    &gt;&gt;&gt; for i in range(20):</span>
<span class="sd">    ...     s.add(a)</span>
<span class="sd">    ...     a += 1</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; assert len(s) == 15</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bell</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="RGS_unrank"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.RGS_unrank">[docs]</a><span class="k">def</span> <span class="nf">RGS_unrank</span><span class="p">(</span><span class="n">rank</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gives the unranked restricted growth string for a given</span>
<span class="sd">    superset size.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.partitions import RGS_unrank</span>
<span class="sd">    &gt;&gt;&gt; RGS_unrank(14, 4)</span>
<span class="sd">    [0, 1, 2, 3]</span>
<span class="sd">    &gt;&gt;&gt; RGS_unrank(0, 4)</span>
<span class="sd">    [0, 0, 0, 0]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The superset size must be &gt;= 1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rank</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">RGS_enum</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">rank</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Invalid arguments&quot;</span><span class="p">)</span>

    <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">RGS_generalized</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="n">j</span><span class="o">*</span><span class="n">v</span>
        <span class="k">if</span> <span class="n">cr</span> <span class="o">&lt;=</span> <span class="n">rank</span><span class="p">:</span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">rank</span> <span class="o">-=</span> <span class="n">cr</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rank</span> <span class="o">/</span> <span class="n">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">rank</span> <span class="o">%=</span> <span class="n">v</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>

</div>
<div class="viewcode-block" id="RGS_rank"><a class="viewcode-back" href="../../../modules/combinatorics/partitions.html#sympy.combinatorics.partitions.RGS_rank">[docs]</a><span class="k">def</span> <span class="nf">RGS_rank</span><span class="p">(</span><span class="n">rgs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the rank of a restricted growth string.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.combinatorics.partitions import RGS_rank, RGS_unrank</span>
<span class="sd">    &gt;&gt;&gt; RGS_rank([0, 1, 2, 1, 3])</span>
<span class="sd">    42</span>
<span class="sd">    &gt;&gt;&gt; RGS_rank(RGS_unrank(4, 7))</span>
<span class="sd">    4</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rgs_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgs</span><span class="p">)</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">RGS_generalized</span><span class="p">(</span><span class="n">rgs_size</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rgs_size</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgs</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):])</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rgs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">])</span>
        <span class="n">rank</span> <span class="o">+=</span> <span class="n">D</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">rgs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rank</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">SymPy 0.7.3 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../sympy.html" >sympy</a> &raquo;</li>
          <li><a href="../combinatorics.html" >sympy.combinatorics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013 SymPy Development Team.
      Last updated on Aug 04, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>