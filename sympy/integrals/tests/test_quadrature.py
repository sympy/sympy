from sympy.integrals.quadrature import gauss_legendre, gauss_laguerre, gauss_hermite

def test_legendre():
    x, w = gauss_legendre(1, 17)
    assert [str(r) for r in x] == ['0']
    assert [str(r) for r in w] == ['2.0000000000000000']

    x, w = gauss_legendre(2, 17)
    assert [str(r) for r in x] == ['-0.57735026918962576',
            '0.57735026918962576']
    assert [str(r) for r in w] == ['1.0000000000000000', '1.0000000000000000']

    x, w = gauss_legendre(3, 17)
    assert [str(r) for r in x] == ['-0.77459666924148338', '0',
            '0.77459666924148338']
    assert [str(r) for r in w] == ['0.55555555555555556',
            '0.88888888888888889', '0.55555555555555556']

    x, w = gauss_legendre(4, 17)
    assert [str(r) for r in x] == ['-0.86113631159405258',
            '-0.33998104358485626', '0.33998104358485626',
            '0.86113631159405258']
    assert [str(r) for r in w] == ['0.34785484513745386',
            '0.65214515486254614', '0.65214515486254614',
            '0.34785484513745386']

def test_legendre_precise():
    x, w = gauss_legendre(3, 40)
    assert [str(r) for r in x] == \
            ['-0.7745966692414833770358530799564799221666', '0',
                    '0.7745966692414833770358530799564799221666']
    assert [str(r) for r in w] == \
            ['0.5555555555555555555555555555555555555556',
                    '0.8888888888888888888888888888888888888889',
                    '0.5555555555555555555555555555555555555556']

def test_laguerre():
    x, w = gauss_laguerre(1, 17)
    assert [str(r) for r in x] == ['1.0000000000000000']
    assert [str(r) for r in w] == ['1.0000000000000000']

    x, w = gauss_laguerre(2, 17)
    assert [str(r) for r in x] == ['0.58578643762690495',
        '3.4142135623730950']
    assert [str(r) for r in w] == ['0.85355339059327376',
            '0.14644660940672624']

    x, w = gauss_laguerre(3, 17)
    assert [str(r) for r in x] == [
            "0.41577455678347908",
            "2.2942803602790417",
            "6.2899450829374792",
            ]
    assert [str(r) for r in w] == [
            "0.71109300992917302",
            "0.27851773356924085",
            "0.010389256501586136",
            ]

    x, w = gauss_laguerre(4, 17)
    assert [str(r) for r in x] == ['0.32254768961939231', '1.7457611011583466',
            '4.5366202969211280', '9.3950709123011331']
    assert [str(r) for r in w] == ['0.60315410434163360',
            '0.35741869243779969', '0.038887908515005384',
            '0.00053929470556132745']

    x, w = gauss_laguerre(5, 17)
    assert [str(r) for r in x] == ['0.26356031971814091', '1.4134030591065168',
            '3.5964257710407221', '7.0858100058588376', '12.640800844275783']
    assert [str(r) for r in w] == ['0.52175561058280865',
            '0.39866681108317593', '0.075942449681707595',
            '0.0036117586799220485', '2.3369972385776228e-5']

def test_laguerre_precise():
    x, w = gauss_laguerre(3, 40)
    assert [str(r) for r in x] == \
            ['0.4157745567834790833115338731282744735466',
                    '2.294280360279041719822050361359593868960',
                    '6.289945082937479196866415765512131657493']
    assert [str(r) for r in w] == \
            ['0.7110930099291730154495901911425944313094',
                    '0.2785177335692408488014448884567264810349',
                    '0.01038925650158613574896492040067908765572']

def test_hermite():
    x, w = gauss_hermite(1, 17)
    assert [str(r) for r in x] == ['0']
    assert [str(r) for r in w] == ['1.7724538509055160']

    x, w = gauss_hermite(2, 17)
    assert [str(r) for r in x] == ['-0.70710678118654752',
                                    '0.70710678118654752']

    assert [str(r) for r in w] == ['0.88622692545275801',
                                   '0.88622692545275801']

    x, w = gauss_hermite(3, 17)
    assert [str(r) for r in x] == [
        '-1.2247448713915890',
        '0',
        '1.2247448713915890']
    assert [str(r) for r in w] == [
        '0.29540897515091934',
        '1.1816359006036774',
        '0.29540897515091934']

    x, w = gauss_hermite(4, 17)
    assert [str(r) for r in x] == [
        '-1.6506801238857846',
        '-0.52464762327529032',
        '0.52464762327529032',
        '1.6506801238857846'
        ]
    assert [str(r) for r in w] == [
        '0.081312835447245177',
        '0.80491409000551284',
        '0.80491409000551284',
        '0.081312835447245177'
        ]

    x, w = gauss_hermite(5, 17)
    assert [str(r) for r in x] == [
        '-2.0201828704560856',
        '-0.95857246461381851',
        '0',
        '0.95857246461381851',
        '2.0201828704560856'
        ]
    assert [str(r) for r in w] == [
        '0.019953242059045913',
        '0.39361932315224116',
        '0.94530872048294188',
        '0.39361932315224116',
        '0.019953242059045913'
        ]

def test_hermite_precise():
    x, w = gauss_hermite(3, 40)
    assert [str(r) for r in x] == [
        '-1.224744871391589049098642037352945695983',
        '0',
        '1.224744871391589049098642037352945695983'
        ]
    assert [str(r) for r in w] == [
        '0.2954089751509193378830279138901908637996',
        '1.181635900603677351532111655560763455198',
        '0.2954089751509193378830279138901908637996'
        ]
